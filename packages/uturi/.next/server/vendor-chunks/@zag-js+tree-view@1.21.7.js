"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@zag-js+tree-view@1.21.7";
exports.ids = ["vendor-chunks/@zag-js+tree-view@1.21.7"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@zag-js+tree-view@1.21.7/node_modules/@zag-js/tree-view/dist/index.mjs":
/*!*******************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@zag-js+tree-view@1.21.7/node_modules/@zag-js/tree-view/dist/index.mjs ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   anatomy: () => (/* binding */ anatomy),\n/* harmony export */   collection: () => (/* binding */ collection),\n/* harmony export */   connect: () => (/* binding */ connect),\n/* harmony export */   filePathCollection: () => (/* binding */ filePathCollection),\n/* harmony export */   itemProps: () => (/* binding */ itemProps),\n/* harmony export */   machine: () => (/* binding */ machine),\n/* harmony export */   props: () => (/* binding */ props),\n/* harmony export */   splitItemProps: () => (/* binding */ splitItemProps),\n/* harmony export */   splitProps: () => (/* binding */ splitProps)\n/* harmony export */ });\n/* harmony import */ var _zag_js_anatomy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @zag-js/anatomy */ \"(ssr)/../../node_modules/.pnpm/@zag-js+anatomy@1.21.7/node_modules/@zag-js/anatomy/dist/index.mjs\");\n/* harmony import */ var _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @zag-js/collection */ \"(ssr)/../../node_modules/.pnpm/@zag-js+collection@1.21.7/node_modules/@zag-js/collection/dist/index.mjs\");\n/* harmony import */ var _zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @zag-js/dom-query */ \"(ssr)/../../node_modules/.pnpm/@zag-js+dom-query@1.21.7/node_modules/@zag-js/dom-query/dist/index.mjs\");\n/* harmony import */ var _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @zag-js/utils */ \"(ssr)/../../node_modules/.pnpm/@zag-js+utils@1.21.7/node_modules/@zag-js/utils/dist/index.mjs\");\n/* harmony import */ var _zag_js_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @zag-js/core */ \"(ssr)/../../node_modules/.pnpm/@zag-js+core@1.21.7/node_modules/@zag-js/core/dist/index.mjs\");\n/* harmony import */ var _zag_js_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @zag-js/types */ \"(ssr)/../../node_modules/.pnpm/@zag-js+types@1.21.7/node_modules/@zag-js/types/dist/index.mjs\");\n\n\n\n\n\n\n\n// src/tree-view.anatomy.ts\nvar anatomy = (0,_zag_js_anatomy__WEBPACK_IMPORTED_MODULE_0__.createAnatomy)(\"tree-view\").parts(\n  \"branch\",\n  \"branchContent\",\n  \"branchControl\",\n  \"branchIndentGuide\",\n  \"branchIndicator\",\n  \"branchText\",\n  \"branchTrigger\",\n  \"item\",\n  \"itemIndicator\",\n  \"itemText\",\n  \"label\",\n  \"nodeCheckbox\",\n  \"root\",\n  \"tree\"\n);\nvar parts = anatomy.build();\nvar collection = (options) => {\n  return new _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.TreeCollection(options);\n};\ncollection.empty = () => {\n  return new _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.TreeCollection({ rootNode: { children: [] } });\n};\nfunction filePathCollection(paths) {\n  return (0,_zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.filePathToTree)(paths);\n}\n\n// src/tree-view.dom.ts\nvar getRootId = (ctx) => ctx.ids?.root ?? `tree:${ctx.id}:root`;\nvar getLabelId = (ctx) => ctx.ids?.label ?? `tree:${ctx.id}:label`;\nvar getNodeId = (ctx, value) => ctx.ids?.node?.(value) ?? `tree:${ctx.id}:node:${value}`;\nvar getTreeId = (ctx) => ctx.ids?.tree ?? `tree:${ctx.id}:tree`;\nvar focusNode = (ctx, value) => {\n  if (value == null) return;\n  ctx.getById(getNodeId(ctx, value))?.focus();\n};\nfunction getCheckedState(collection2, node, checkedValue) {\n  const value = collection2.getNodeValue(node);\n  if (!collection2.isBranchNode(node)) {\n    return checkedValue.includes(value);\n  }\n  const childValues = collection2.getDescendantValues(value);\n  const allChecked = childValues.every((v) => checkedValue.includes(v));\n  const someChecked = childValues.some((v) => checkedValue.includes(v));\n  return allChecked ? true : someChecked ? \"indeterminate\" : false;\n}\nfunction toggleBranchChecked(collection2, value, checkedValue) {\n  const childValues = collection2.getDescendantValues(value);\n  const allChecked = childValues.every((child) => checkedValue.includes(child));\n  return (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(allChecked ? (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(checkedValue, ...childValues) : (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(checkedValue, ...childValues));\n}\nfunction getCheckedValueMap(collection2, checkedValue) {\n  const map = /* @__PURE__ */ new Map();\n  collection2.visit({\n    onEnter: (node) => {\n      const value = collection2.getNodeValue(node);\n      const isBranch = collection2.isBranchNode(node);\n      const checked = getCheckedState(collection2, node, checkedValue);\n      map.set(value, {\n        type: isBranch ? \"branch\" : \"leaf\",\n        checked\n      });\n    }\n  });\n  return map;\n}\n\n// src/tree-view.connect.ts\nfunction connect(service, normalize) {\n  const { context, scope, computed, prop, send } = service;\n  const collection2 = prop(\"collection\");\n  const expandedValue = Array.from(context.get(\"expandedValue\"));\n  const selectedValue = Array.from(context.get(\"selectedValue\"));\n  const checkedValue = Array.from(context.get(\"checkedValue\"));\n  const isTypingAhead = computed(\"isTypingAhead\");\n  const focusedValue = context.get(\"focusedValue\");\n  const loadingStatus = context.get(\"loadingStatus\");\n  function getNodeState(props2) {\n    const { node, indexPath } = props2;\n    const value = collection2.getNodeValue(node);\n    const firstNode = collection2.getFirstNode();\n    const firstNodeValue = firstNode ? collection2.getNodeValue(firstNode) : null;\n    return {\n      id: getNodeId(scope, value),\n      value,\n      indexPath,\n      valuePath: collection2.getValuePath(indexPath),\n      disabled: Boolean(node.disabled),\n      focused: focusedValue == null ? firstNodeValue == value : focusedValue === value,\n      selected: selectedValue.includes(value),\n      expanded: expandedValue.includes(value),\n      loading: loadingStatus[value] === \"loading\",\n      depth: indexPath.length,\n      isBranch: collection2.isBranchNode(node),\n      get checked() {\n        return getCheckedState(collection2, node, checkedValue);\n      }\n    };\n  }\n  return {\n    collection: collection2,\n    expandedValue,\n    selectedValue,\n    checkedValue,\n    toggleChecked(value, isBranch) {\n      send({ type: \"CHECKED.TOGGLE\", value, isBranch });\n    },\n    setChecked(value) {\n      send({ type: \"CHECKED.SET\", value });\n    },\n    clearChecked() {\n      send({ type: \"CHECKED.CLEAR\" });\n    },\n    getCheckedMap() {\n      return getCheckedValueMap(collection2, checkedValue);\n    },\n    expand(value) {\n      send({ type: value ? \"BRANCH.EXPAND\" : \"EXPANDED.ALL\", value });\n    },\n    collapse(value) {\n      send({ type: value ? \"BRANCH.COLLAPSE\" : \"EXPANDED.CLEAR\", value });\n    },\n    deselect(value) {\n      send({ type: value ? \"NODE.DESELECT\" : \"SELECTED.CLEAR\", value });\n    },\n    select(value) {\n      send({ type: value ? \"NODE.SELECT\" : \"SELECTED.ALL\", value, isTrusted: false });\n    },\n    getVisibleNodes() {\n      return computed(\"visibleNodes\").map(({ node }) => node);\n    },\n    focus(value) {\n      focusNode(scope, value);\n    },\n    selectParent(value) {\n      const parentNode = collection2.getParentNode(value);\n      if (!parentNode) return;\n      const _selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(selectedValue, collection2.getNodeValue(parentNode));\n      send({ type: \"SELECTED.SET\", value: _selectedValue, src: \"select.parent\" });\n    },\n    expandParent(value) {\n      const parentNode = collection2.getParentNode(value);\n      if (!parentNode) return;\n      const _expandedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(expandedValue, collection2.getNodeValue(parentNode));\n      send({ type: \"EXPANDED.SET\", value: _expandedValue, src: \"expand.parent\" });\n    },\n    setExpandedValue(value) {\n      const _expandedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(value);\n      send({ type: \"EXPANDED.SET\", value: _expandedValue });\n    },\n    setSelectedValue(value) {\n      const _selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(value);\n      send({ type: \"SELECTED.SET\", value: _selectedValue });\n    },\n    getRootProps() {\n      return normalize.element({\n        ...parts.root.attrs,\n        id: getRootId(scope),\n        dir: prop(\"dir\")\n      });\n    },\n    getLabelProps() {\n      return normalize.element({\n        ...parts.label.attrs,\n        id: getLabelId(scope),\n        dir: prop(\"dir\")\n      });\n    },\n    getTreeProps() {\n      return normalize.element({\n        ...parts.tree.attrs,\n        id: getTreeId(scope),\n        dir: prop(\"dir\"),\n        role: \"tree\",\n        \"aria-label\": \"Tree View\",\n        \"aria-labelledby\": getLabelId(scope),\n        \"aria-multiselectable\": prop(\"selectionMode\") === \"multiple\" || void 0,\n        tabIndex: -1,\n        onKeyDown(event) {\n          if (event.defaultPrevented) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isComposingEvent)(event)) return;\n          const target = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getEventTarget)(event);\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isEditableElement)(target)) return;\n          const node = target?.closest(\"[data-part=branch-control], [data-part=item]\");\n          if (!node) return;\n          const nodeId = node.dataset.value;\n          if (nodeId == null) {\n            console.warn(`[zag-js/tree-view] Node id not found for node`, node);\n            return;\n          }\n          const isBranchNode = node.matches(\"[data-part=branch-control]\");\n          const keyMap = {\n            ArrowDown(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.ARROW_DOWN\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            ArrowUp(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.ARROW_UP\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            ArrowLeft(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2) || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: isBranchNode ? \"BRANCH_NODE.ARROW_LEFT\" : \"NODE.ARROW_LEFT\", id: nodeId });\n            },\n            ArrowRight(event2) {\n              if (!isBranchNode || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"BRANCH_NODE.ARROW_RIGHT\", id: nodeId });\n            },\n            Home(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.HOME\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            End(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.END\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            Space(event2) {\n              if (node.dataset.disabled) return;\n              if (isTypingAhead) {\n                send({ type: \"TREE.TYPEAHEAD\", key: event2.key });\n              } else {\n                keyMap.Enter?.(event2);\n              }\n            },\n            Enter(event2) {\n              if (node.dataset.disabled) return;\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(target) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              send({ type: isBranchNode ? \"BRANCH_NODE.CLICK\" : \"NODE.CLICK\", id: nodeId, src: \"keyboard\" });\n              if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(target)) {\n                event2.preventDefault();\n              }\n            },\n            \"*\"(event2) {\n              if (node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"SIBLINGS.EXPAND\", id: nodeId });\n            },\n            a(event2) {\n              if (!event2.metaKey || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"SELECTED.ALL\", moveFocus: true });\n            }\n          };\n          const key = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getEventKey)(event, { dir: prop(\"dir\") });\n          const exec = keyMap[key];\n          if (exec) {\n            exec(event);\n            return;\n          }\n          if (!_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead.isValidEvent(event)) return;\n          send({ type: \"TREE.TYPEAHEAD\", key: event.key, id: nodeId });\n          event.preventDefault();\n        }\n      });\n    },\n    getNodeState,\n    getItemProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.item.attrs,\n        id: nodeState.id,\n        dir: prop(\"dir\"),\n        \"data-ownedby\": getTreeId(scope),\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-value\": nodeState.value,\n        tabIndex: nodeState.focused ? 0 : -1,\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        role: \"treeitem\",\n        \"aria-current\": nodeState.selected ? \"true\" : void 0,\n        \"aria-selected\": nodeState.disabled ? void 0 : nodeState.selected,\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"aria-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.disabled),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"aria-level\": nodeState.depth,\n        \"data-depth\": nodeState.depth,\n        style: {\n          \"--depth\": nodeState.depth\n        },\n        onFocus(event) {\n          event.stopPropagation();\n          send({ type: \"NODE.FOCUS\", id: nodeState.value });\n        },\n        onClick(event) {\n          if (nodeState.disabled) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event)) return;\n          const isMetaKey = event.metaKey || event.ctrlKey;\n          send({ type: \"NODE.CLICK\", id: nodeState.value, shiftKey: event.shiftKey, ctrlKey: isMetaKey });\n          event.stopPropagation();\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget)) {\n            event.preventDefault();\n          }\n        }\n      });\n    },\n    getItemTextProps(props2) {\n      const itemState = getNodeState(props2);\n      return normalize.element({\n        ...parts.itemText.attrs,\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.focused)\n      });\n    },\n    getItemIndicatorProps(props2) {\n      const itemState = getNodeState(props2);\n      return normalize.element({\n        ...parts.itemIndicator.attrs,\n        \"aria-hidden\": true,\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.focused),\n        hidden: !itemState.selected\n      });\n    },\n    getBranchProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branch.attrs,\n        \"data-depth\": nodeState.depth,\n        dir: prop(\"dir\"),\n        \"data-branch\": nodeState.value,\n        role: \"treeitem\",\n        \"data-ownedby\": getTreeId(scope),\n        \"data-value\": nodeState.value,\n        \"aria-level\": nodeState.depth,\n        \"aria-selected\": nodeState.disabled ? void 0 : nodeState.selected,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"aria-expanded\": nodeState.expanded,\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"aria-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.disabled),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        \"aria-busy\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.loading),\n        style: {\n          \"--depth\": nodeState.depth\n        }\n      });\n    },\n    getBranchIndicatorProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchIndicator.attrs,\n        \"aria-hidden\": true,\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading)\n      });\n    },\n    getBranchTriggerProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchTrigger.attrs,\n        role: \"button\",\n        dir: prop(\"dir\"),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-value\": nodeState.value,\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        disabled: nodeState.loading,\n        onClick(event) {\n          if (nodeState.disabled || nodeState.loading) return;\n          send({ type: \"BRANCH_TOGGLE.CLICK\", id: nodeState.value });\n          event.stopPropagation();\n        }\n      });\n    },\n    getBranchControlProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchControl.attrs,\n        role: \"button\",\n        id: nodeState.id,\n        dir: prop(\"dir\"),\n        tabIndex: nodeState.focused ? 0 : -1,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        \"data-value\": nodeState.value,\n        \"data-depth\": nodeState.depth,\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        \"aria-busy\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.loading),\n        onFocus(event) {\n          send({ type: \"NODE.FOCUS\", id: nodeState.value });\n          event.stopPropagation();\n        },\n        onClick(event) {\n          if (nodeState.disabled) return;\n          if (nodeState.loading) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event)) return;\n          const isMetaKey = event.metaKey || event.ctrlKey;\n          send({ type: \"BRANCH_NODE.CLICK\", id: nodeState.value, shiftKey: event.shiftKey, ctrlKey: isMetaKey });\n          event.stopPropagation();\n        }\n      });\n    },\n    getBranchTextProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchText.attrs,\n        dir: prop(\"dir\"),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading)\n      });\n    },\n    getBranchContentProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchContent.attrs,\n        role: \"group\",\n        dir: prop(\"dir\"),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-depth\": nodeState.depth,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-value\": nodeState.value,\n        hidden: !nodeState.expanded\n      });\n    },\n    getBranchIndentGuideProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchIndentGuide.attrs,\n        \"data-depth\": nodeState.depth\n      });\n    },\n    getNodeCheckboxProps(props2) {\n      const nodeState = getNodeState(props2);\n      const checkedState = nodeState.checked;\n      return normalize.element({\n        ...parts.nodeCheckbox.attrs,\n        tabIndex: -1,\n        role: \"checkbox\",\n        \"data-state\": checkedState === true ? \"checked\" : checkedState === false ? \"unchecked\" : \"indeterminate\",\n        \"aria-checked\": checkedState === true ? \"true\" : checkedState === false ? \"false\" : \"mixed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        onClick(event) {\n          if (event.defaultPrevented) return;\n          if (nodeState.disabled) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          send({ type: \"CHECKED.TOGGLE\", value: nodeState.value, isBranch: nodeState.isBranch });\n          event.stopPropagation();\n          const node = event.currentTarget.closest(\"[role=treeitem]\");\n          node?.focus({ preventScroll: true });\n        }\n      });\n    }\n  };\n}\nfunction expandBranches(params, values) {\n  const { context, prop, refs } = params;\n  if (!prop(\"loadChildren\")) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...values)));\n    return;\n  }\n  const loadingStatus = context.get(\"loadingStatus\");\n  const [loadedValues, loadingValues] = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.partition)(values, (value) => loadingStatus[value] === \"loaded\");\n  if (loadedValues.length > 0) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...loadedValues)));\n  }\n  if (loadingValues.length === 0) return;\n  const collection2 = prop(\"collection\");\n  const [nodeWithChildren, nodeWithoutChildren] = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.partition)(loadingValues, (id) => {\n    const node = collection2.findNode(id);\n    return collection2.getNodeChildren(node).length > 0;\n  });\n  if (nodeWithChildren.length > 0) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...nodeWithChildren)));\n  }\n  if (nodeWithoutChildren.length === 0) return;\n  context.set(\"loadingStatus\", (prev) => ({\n    ...prev,\n    ...nodeWithoutChildren.reduce((acc, id) => ({ ...acc, [id]: \"loading\" }), {})\n  }));\n  const nodesToLoad = nodeWithoutChildren.map((id) => {\n    const indexPath = collection2.getIndexPath(id);\n    const valuePath = collection2.getValuePath(indexPath);\n    const node = collection2.findNode(id);\n    return { id, indexPath, valuePath, node };\n  });\n  const pendingAborts = refs.get(\"pendingAborts\");\n  const loadChildren = prop(\"loadChildren\");\n  (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.ensure)(loadChildren, () => \"[zag-js/tree-view] `loadChildren` is required for async expansion\");\n  const proms = nodesToLoad.map(({ id, indexPath, valuePath, node }) => {\n    const existingAbort = pendingAborts.get(id);\n    if (existingAbort) {\n      existingAbort.abort();\n      pendingAborts.delete(id);\n    }\n    const abortController = new AbortController();\n    pendingAborts.set(id, abortController);\n    return loadChildren({\n      valuePath,\n      indexPath,\n      node,\n      signal: abortController.signal\n    });\n  });\n  Promise.allSettled(proms).then((results) => {\n    const loadedValues2 = [];\n    const nodeWithErrors = [];\n    const nextLoadingStatus = context.get(\"loadingStatus\");\n    let collection3 = prop(\"collection\");\n    results.forEach((result, index) => {\n      const { id, indexPath, node, valuePath } = nodesToLoad[index];\n      if (result.status === \"fulfilled\") {\n        nextLoadingStatus[id] = \"loaded\";\n        loadedValues2.push(id);\n        collection3 = collection3.replace(indexPath, { ...node, children: result.value });\n      } else {\n        pendingAborts.delete(id);\n        Reflect.deleteProperty(nextLoadingStatus, id);\n        nodeWithErrors.push({ node, error: result.reason, indexPath, valuePath });\n      }\n    });\n    context.set(\"loadingStatus\", nextLoadingStatus);\n    if (loadedValues2.length) {\n      context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...loadedValues2)));\n      prop(\"onLoadChildrenComplete\")?.({ collection: collection3 });\n    }\n    if (nodeWithErrors.length) {\n      prop(\"onLoadChildrenError\")?.({ nodes: nodeWithErrors });\n    }\n  });\n}\n\n// src/utils/visit-skip.ts\nfunction skipFn(params) {\n  const { prop, context } = params;\n  return function skip({ indexPath }) {\n    const paths = prop(\"collection\").getValuePath(indexPath).slice(0, -1);\n    return paths.some((value) => !context.get(\"expandedValue\").includes(value));\n  };\n}\n\n// src/tree-view.machine.ts\nvar { and } = (0,_zag_js_core__WEBPACK_IMPORTED_MODULE_4__.createGuards)();\nvar machine = (0,_zag_js_core__WEBPACK_IMPORTED_MODULE_4__.createMachine)({\n  props({ props: props2 }) {\n    return {\n      selectionMode: \"single\",\n      collection: collection.empty(),\n      typeahead: true,\n      expandOnClick: true,\n      defaultExpandedValue: [],\n      defaultSelectedValue: [],\n      ...props2\n    };\n  },\n  initialState() {\n    return \"idle\";\n  },\n  context({ prop, bindable, getContext }) {\n    return {\n      expandedValue: bindable(() => ({\n        defaultValue: prop(\"defaultExpandedValue\"),\n        value: prop(\"expandedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(expandedValue) {\n          const ctx = getContext();\n          const focusedValue = ctx.get(\"focusedValue\");\n          prop(\"onExpandedChange\")?.({\n            expandedValue,\n            focusedValue,\n            get expandedNodes() {\n              return prop(\"collection\").findNodes(expandedValue);\n            }\n          });\n        }\n      })),\n      selectedValue: bindable(() => ({\n        defaultValue: prop(\"defaultSelectedValue\"),\n        value: prop(\"selectedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(selectedValue) {\n          const ctx = getContext();\n          const focusedValue = ctx.get(\"focusedValue\");\n          prop(\"onSelectionChange\")?.({\n            selectedValue,\n            focusedValue,\n            get selectedNodes() {\n              return prop(\"collection\").findNodes(selectedValue);\n            }\n          });\n        }\n      })),\n      focusedValue: bindable(() => ({\n        defaultValue: prop(\"defaultFocusedValue\") || null,\n        value: prop(\"focusedValue\"),\n        onChange(focusedValue) {\n          prop(\"onFocusChange\")?.({\n            focusedValue,\n            get focusedNode() {\n              return focusedValue ? prop(\"collection\").findNode(focusedValue) : null;\n            }\n          });\n        }\n      })),\n      loadingStatus: bindable(() => ({\n        defaultValue: {}\n      })),\n      checkedValue: bindable(() => ({\n        defaultValue: prop(\"defaultCheckedValue\") || [],\n        value: prop(\"checkedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(value) {\n          prop(\"onCheckedChange\")?.({ checkedValue: value });\n        }\n      }))\n    };\n  },\n  refs() {\n    return {\n      typeaheadState: { ..._zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead.defaultOptions },\n      pendingAborts: /* @__PURE__ */ new Map()\n    };\n  },\n  computed: {\n    isMultipleSelection: ({ prop }) => prop(\"selectionMode\") === \"multiple\",\n    isTypingAhead: ({ refs }) => refs.get(\"typeaheadState\").keysSoFar.length > 0,\n    visibleNodes: ({ prop, context }) => {\n      const nodes = [];\n      prop(\"collection\").visit({\n        skip: skipFn({ prop, context }),\n        onEnter: (node, indexPath) => {\n          nodes.push({ node, indexPath });\n        }\n      });\n      return nodes;\n    }\n  },\n  on: {\n    \"EXPANDED.SET\": {\n      actions: [\"setExpanded\"]\n    },\n    \"EXPANDED.CLEAR\": {\n      actions: [\"clearExpanded\"]\n    },\n    \"EXPANDED.ALL\": {\n      actions: [\"expandAllBranches\"]\n    },\n    \"BRANCH.EXPAND\": {\n      actions: [\"expandBranches\"]\n    },\n    \"BRANCH.COLLAPSE\": {\n      actions: [\"collapseBranches\"]\n    },\n    \"SELECTED.SET\": {\n      actions: [\"setSelected\"]\n    },\n    \"SELECTED.ALL\": [\n      {\n        guard: and(\"isMultipleSelection\", \"moveFocus\"),\n        actions: [\"selectAllNodes\", \"focusTreeLastNode\"]\n      },\n      {\n        guard: \"isMultipleSelection\",\n        actions: [\"selectAllNodes\"]\n      }\n    ],\n    \"SELECTED.CLEAR\": {\n      actions: [\"clearSelected\"]\n    },\n    \"NODE.SELECT\": {\n      actions: [\"selectNode\"]\n    },\n    \"NODE.DESELECT\": {\n      actions: [\"deselectNode\"]\n    },\n    \"CHECKED.TOGGLE\": {\n      actions: [\"toggleChecked\"]\n    },\n    \"CHECKED.SET\": {\n      actions: [\"setChecked\"]\n    },\n    \"CHECKED.CLEAR\": {\n      actions: [\"clearChecked\"]\n    }\n  },\n  exit: [\"clearPendingAborts\"],\n  states: {\n    idle: {\n      on: {\n        \"NODE.FOCUS\": {\n          actions: [\"setFocusedNode\"]\n        },\n        \"NODE.ARROW_DOWN\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"focusTreeNextNode\", \"extendSelectionToNextNode\"]\n          },\n          {\n            actions: [\"focusTreeNextNode\"]\n          }\n        ],\n        \"NODE.ARROW_UP\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"focusTreePrevNode\", \"extendSelectionToPrevNode\"]\n          },\n          {\n            actions: [\"focusTreePrevNode\"]\n          }\n        ],\n        \"NODE.ARROW_LEFT\": {\n          actions: [\"focusBranchNode\"]\n        },\n        \"BRANCH_NODE.ARROW_LEFT\": [\n          {\n            guard: \"isBranchExpanded\",\n            actions: [\"collapseBranch\"]\n          },\n          {\n            actions: [\"focusBranchNode\"]\n          }\n        ],\n        \"BRANCH_NODE.ARROW_RIGHT\": [\n          {\n            guard: and(\"isBranchFocused\", \"isBranchExpanded\"),\n            actions: [\"focusBranchFirstNode\"]\n          },\n          {\n            actions: [\"expandBranch\"]\n          }\n        ],\n        \"SIBLINGS.EXPAND\": {\n          actions: [\"expandSiblingBranches\"]\n        },\n        \"NODE.HOME\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToFirstNode\", \"focusTreeFirstNode\"]\n          },\n          {\n            actions: [\"focusTreeFirstNode\"]\n          }\n        ],\n        \"NODE.END\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToLastNode\", \"focusTreeLastNode\"]\n          },\n          {\n            actions: [\"focusTreeLastNode\"]\n          }\n        ],\n        \"NODE.CLICK\": [\n          {\n            guard: and(\"isCtrlKey\", \"isMultipleSelection\"),\n            actions: [\"toggleNodeSelection\"]\n          },\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToNode\"]\n          },\n          {\n            actions: [\"selectNode\"]\n          }\n        ],\n        \"BRANCH_NODE.CLICK\": [\n          {\n            guard: and(\"isCtrlKey\", \"isMultipleSelection\"),\n            actions: [\"toggleNodeSelection\"]\n          },\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToNode\"]\n          },\n          {\n            guard: \"expandOnClick\",\n            actions: [\"selectNode\", \"toggleBranchNode\"]\n          },\n          {\n            actions: [\"selectNode\"]\n          }\n        ],\n        \"BRANCH_TOGGLE.CLICK\": {\n          actions: [\"toggleBranchNode\"]\n        },\n        \"TREE.TYPEAHEAD\": {\n          actions: [\"focusMatchedNode\"]\n        }\n      }\n    }\n  },\n  implementations: {\n    guards: {\n      isBranchFocused: ({ context, event }) => context.get(\"focusedValue\") === event.id,\n      isBranchExpanded: ({ context, event }) => context.get(\"expandedValue\").includes(event.id),\n      isShiftKey: ({ event }) => event.shiftKey,\n      isCtrlKey: ({ event }) => event.ctrlKey,\n      hasSelectedItems: ({ context }) => context.get(\"selectedValue\").length > 0,\n      isMultipleSelection: ({ prop }) => prop(\"selectionMode\") === \"multiple\",\n      moveFocus: ({ event }) => !!event.moveFocus,\n      expandOnClick: ({ prop }) => !!prop(\"expandOnClick\")\n    },\n    actions: {\n      selectNode({ context, event }) {\n        const value = event.id || event.value;\n        context.set(\"selectedValue\", (prev) => {\n          if (value == null) return prev;\n          if (!event.isTrusted && (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(value)) return prev.concat(...value);\n          return [(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(value) ? (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.last)(value) : value].filter(Boolean);\n        });\n      },\n      deselectNode({ context, event }) {\n        const value = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.id || event.value);\n        context.set(\"selectedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, ...value));\n      },\n      setFocusedNode({ context, event }) {\n        context.set(\"focusedValue\", event.id);\n      },\n      clearFocusedNode({ context }) {\n        context.set(\"focusedValue\", null);\n      },\n      clearSelectedItem({ context }) {\n        context.set(\"selectedValue\", []);\n      },\n      toggleBranchNode({ context, event, action }) {\n        const isExpanded = context.get(\"expandedValue\").includes(event.id);\n        action(isExpanded ? [\"collapseBranch\"] : [\"expandBranch\"]);\n      },\n      expandBranch(params) {\n        const { event } = params;\n        expandBranches(params, [event.id]);\n      },\n      expandBranches(params) {\n        const { context, event } = params;\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.value);\n        expandBranches(params, (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(valuesToExpand, context.get(\"expandedValue\")));\n      },\n      collapseBranch({ context, event }) {\n        context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, event.id));\n      },\n      collapseBranches(params) {\n        const { context, event } = params;\n        const value = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.value);\n        context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, ...value));\n      },\n      setExpanded({ context, event }) {\n        if (!(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(event.value)) return;\n        context.set(\"expandedValue\", event.value);\n      },\n      clearExpanded({ context }) {\n        context.set(\"expandedValue\", []);\n      },\n      setSelected({ context, event }) {\n        if (!(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(event.value)) return;\n        context.set(\"selectedValue\", event.value);\n      },\n      clearSelected({ context }) {\n        context.set(\"selectedValue\", []);\n      },\n      focusTreeFirstNode({ prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const firstNode = collection2.getFirstNode();\n        const firstValue = collection2.getNodeValue(firstNode);\n        focusNode(scope, firstValue);\n      },\n      focusTreeLastNode(params) {\n        const { prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const lastNode = collection2.getLastNode(void 0, { skip: skipFn(params) });\n        const lastValue = collection2.getNodeValue(lastNode);\n        focusNode(scope, lastValue);\n      },\n      focusBranchFirstNode({ event, prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const branchNode = collection2.findNode(event.id);\n        const firstNode = collection2.getFirstNode(branchNode);\n        const firstValue = collection2.getNodeValue(firstNode);\n        focusNode(scope, firstValue);\n      },\n      focusTreeNextNode(params) {\n        const { event, prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const nextNode = collection2.getNextNode(event.id, { skip: skipFn(params) });\n        if (!nextNode) return;\n        const nextValue = collection2.getNodeValue(nextNode);\n        focusNode(scope, nextValue);\n      },\n      focusTreePrevNode(params) {\n        const { event, prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const prevNode = collection2.getPreviousNode(event.id, { skip: skipFn(params) });\n        if (!prevNode) return;\n        const prevValue = collection2.getNodeValue(prevNode);\n        focusNode(scope, prevValue);\n      },\n      focusBranchNode({ event, prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const parentNode = collection2.getParentNode(event.id);\n        const parentValue = parentNode ? collection2.getNodeValue(parentNode) : void 0;\n        focusNode(scope, parentValue);\n      },\n      selectAllNodes({ context, prop }) {\n        context.set(\"selectedValue\", prop(\"collection\").getValues());\n      },\n      focusMatchedNode(params) {\n        const { context, prop, refs, event, scope, computed } = params;\n        const nodes = computed(\"visibleNodes\");\n        const elements = nodes.map(({ node: node2 }) => ({\n          textContent: prop(\"collection\").stringifyNode(node2),\n          id: prop(\"collection\").getNodeValue(node2)\n        }));\n        const node = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead)(elements, {\n          state: refs.get(\"typeaheadState\"),\n          activeId: context.get(\"focusedValue\"),\n          key: event.key\n        });\n        focusNode(scope, node?.id);\n      },\n      toggleNodeSelection({ context, event }) {\n        const selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.addOrRemove)(context.get(\"selectedValue\"), event.id);\n        context.set(\"selectedValue\", selectedValue);\n      },\n      expandAllBranches(params) {\n        const { context, prop } = params;\n        const branchValues = prop(\"collection\").getBranchValues();\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(branchValues, context.get(\"expandedValue\"));\n        expandBranches(params, valuesToExpand);\n      },\n      expandSiblingBranches(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const indexPath = collection2.getIndexPath(event.id);\n        if (!indexPath) return;\n        const nodes = collection2.getSiblingNodes(indexPath);\n        const values = nodes.map((node) => collection2.getNodeValue(node));\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(values, context.get(\"expandedValue\"));\n        expandBranches(params, valuesToExpand);\n      },\n      extendSelectionToNode(params) {\n        const { context, event, prop, computed } = params;\n        const collection2 = prop(\"collection\");\n        const anchorValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\")) || collection2.getNodeValue(collection2.getFirstNode());\n        const targetValue = event.id;\n        let values = [anchorValue, targetValue];\n        let hits = 0;\n        const visibleNodes = computed(\"visibleNodes\");\n        visibleNodes.forEach(({ node }) => {\n          const nodeValue = collection2.getNodeValue(node);\n          if (hits === 1) values.push(nodeValue);\n          if (nodeValue === anchorValue || nodeValue === targetValue) hits++;\n        });\n        context.set(\"selectedValue\", (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(values));\n      },\n      extendSelectionToNextNode(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const nextNode = collection2.getNextNode(event.id, { skip: skipFn(params) });\n        if (!nextNode) return;\n        const values = new Set(context.get(\"selectedValue\"));\n        const nextValue = collection2.getNodeValue(nextNode);\n        if (nextValue == null) return;\n        if (values.has(event.id) && values.has(nextValue)) {\n          values.delete(event.id);\n        } else if (!values.has(nextValue)) {\n          values.add(nextValue);\n        }\n        context.set(\"selectedValue\", Array.from(values));\n      },\n      extendSelectionToPrevNode(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const prevNode = collection2.getPreviousNode(event.id, { skip: skipFn(params) });\n        if (!prevNode) return;\n        const values = new Set(context.get(\"selectedValue\"));\n        const prevValue = collection2.getNodeValue(prevNode);\n        if (prevValue == null) return;\n        if (values.has(event.id) && values.has(prevValue)) {\n          values.delete(event.id);\n        } else if (!values.has(prevValue)) {\n          values.add(prevValue);\n        }\n        context.set(\"selectedValue\", Array.from(values));\n      },\n      extendSelectionToFirstNode(params) {\n        const { context, prop } = params;\n        const collection2 = prop(\"collection\");\n        const currentSelection = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\"));\n        const values = [];\n        collection2.visit({\n          skip: skipFn(params),\n          onEnter: (node) => {\n            const nodeValue = collection2.getNodeValue(node);\n            values.push(nodeValue);\n            if (nodeValue === currentSelection) {\n              return \"stop\";\n            }\n          }\n        });\n        context.set(\"selectedValue\", values);\n      },\n      extendSelectionToLastNode(params) {\n        const { context, prop } = params;\n        const collection2 = prop(\"collection\");\n        const currentSelection = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\"));\n        const values = [];\n        let current = false;\n        collection2.visit({\n          skip: skipFn(params),\n          onEnter: (node) => {\n            const nodeValue = collection2.getNodeValue(node);\n            if (nodeValue === currentSelection) current = true;\n            if (current) values.push(nodeValue);\n          }\n        });\n        context.set(\"selectedValue\", values);\n      },\n      clearPendingAborts({ refs }) {\n        const aborts = refs.get(\"pendingAborts\");\n        aborts.forEach((abort) => abort.abort());\n        aborts.clear();\n      },\n      toggleChecked({ context, event, prop }) {\n        const collection2 = prop(\"collection\");\n        context.set(\n          \"checkedValue\",\n          (prev) => event.isBranch ? toggleBranchChecked(collection2, event.value, prev) : (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.addOrRemove)(prev, event.value)\n        );\n      },\n      setChecked({ context, event }) {\n        context.set(\"checkedValue\", event.value);\n      },\n      clearChecked({ context }) {\n        context.set(\"checkedValue\", []);\n      }\n    }\n  }\n});\nvar props = (0,_zag_js_types__WEBPACK_IMPORTED_MODULE_5__.createProps)()([\n  \"ids\",\n  \"collection\",\n  \"dir\",\n  \"expandedValue\",\n  \"expandOnClick\",\n  \"defaultFocusedValue\",\n  \"focusedValue\",\n  \"getRootNode\",\n  \"id\",\n  \"onExpandedChange\",\n  \"onFocusChange\",\n  \"onSelectionChange\",\n  \"checkedValue\",\n  \"selectedValue\",\n  \"selectionMode\",\n  \"typeahead\",\n  \"defaultExpandedValue\",\n  \"defaultSelectedValue\",\n  \"defaultCheckedValue\",\n  \"onCheckedChange\",\n  \"onLoadChildrenComplete\",\n  \"onLoadChildrenError\",\n  \"loadChildren\"\n]);\nvar splitProps = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.createSplitProps)(props);\nvar itemProps = (0,_zag_js_types__WEBPACK_IMPORTED_MODULE_5__.createProps)()([\"node\", \"indexPath\"]);\nvar splitItemProps = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.createSplitProps)(itemProps);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B6YWctanMrdHJlZS12aWV3QDEuMjEuNy9ub2RlX21vZHVsZXMvQHphZy1qcy90cmVlLXZpZXcvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWdEO0FBQ29CO0FBQ2tIO0FBQ3BDO0FBQ3ZGO0FBQ2Y7O0FBRTVDO0FBQ0EsY0FBYyw4REFBYTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw4REFBYztBQUMzQjtBQUNBO0FBQ0EsYUFBYSw4REFBYyxHQUFHLFlBQVksZ0JBQWdCO0FBQzFEO0FBQ0E7QUFDQSxTQUFTLGtFQUFjO0FBQ3ZCOztBQUVBO0FBQ0Esa0RBQWtELE9BQU87QUFDekQsb0RBQW9ELE9BQU87QUFDM0Qsa0VBQWtFLE9BQU8sUUFBUSxNQUFNO0FBQ3ZGLGtEQUFrRCxPQUFPO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLG1EQUFJLGNBQWMscURBQU0saUNBQWlDLGtEQUFHO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSx1Q0FBdUM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0JBQWtCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsK0RBQWdCO0FBQ2pDLGdCQUFnQiwwREFBVztBQUMzQixxQkFBcUIsK0RBQWdCOztBQUU4RSIsInNvdXJjZXMiOlsid2VicGFjazovL0B1dHVyaS91dHVyaS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHphZy1qcyt0cmVlLXZpZXdAMS4yMS43L25vZGVfbW9kdWxlcy9AemFnLWpzL3RyZWUtdmlldy9kaXN0L2luZGV4Lm1qcz9mMGVmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUFuYXRvbXkgfSBmcm9tICdAemFnLWpzL2FuYXRvbXknO1xuaW1wb3J0IHsgVHJlZUNvbGxlY3Rpb24sIGZpbGVQYXRoVG9UcmVlIH0gZnJvbSAnQHphZy1qcy9jb2xsZWN0aW9uJztcbmltcG9ydCB7IGdldEJ5VHlwZWFoZWFkLCBkYXRhQXR0ciwgaXNMZWZ0Q2xpY2ssIGFyaWFBdHRyLCBpc0FuY2hvckVsZW1lbnQsIGlzTW9kaWZpZXJLZXksIGlzQ29tcG9zaW5nRXZlbnQsIGdldEV2ZW50VGFyZ2V0LCBpc0VkaXRhYmxlRWxlbWVudCwgZ2V0RXZlbnRLZXkgfSBmcm9tICdAemFnLWpzL2RvbS1xdWVyeSc7XG5pbXBvcnQgeyBhZGRPclJlbW92ZSwgZmlyc3QsIHVuaXEsIGRpZmYsIGlzQXJyYXksIHRvQXJyYXksIHJlbW92ZSwgbGFzdCwgaXNFcXVhbCwgY3JlYXRlU3BsaXRQcm9wcywgYWRkLCBwYXJ0aXRpb24sIGVuc3VyZSB9IGZyb20gJ0B6YWctanMvdXRpbHMnO1xuaW1wb3J0IHsgY3JlYXRlR3VhcmRzLCBjcmVhdGVNYWNoaW5lIH0gZnJvbSAnQHphZy1qcy9jb3JlJztcbmltcG9ydCB7IGNyZWF0ZVByb3BzIH0gZnJvbSAnQHphZy1qcy90eXBlcyc7XG5cbi8vIHNyYy90cmVlLXZpZXcuYW5hdG9teS50c1xudmFyIGFuYXRvbXkgPSBjcmVhdGVBbmF0b215KFwidHJlZS12aWV3XCIpLnBhcnRzKFxuICBcImJyYW5jaFwiLFxuICBcImJyYW5jaENvbnRlbnRcIixcbiAgXCJicmFuY2hDb250cm9sXCIsXG4gIFwiYnJhbmNoSW5kZW50R3VpZGVcIixcbiAgXCJicmFuY2hJbmRpY2F0b3JcIixcbiAgXCJicmFuY2hUZXh0XCIsXG4gIFwiYnJhbmNoVHJpZ2dlclwiLFxuICBcIml0ZW1cIixcbiAgXCJpdGVtSW5kaWNhdG9yXCIsXG4gIFwiaXRlbVRleHRcIixcbiAgXCJsYWJlbFwiLFxuICBcIm5vZGVDaGVja2JveFwiLFxuICBcInJvb3RcIixcbiAgXCJ0cmVlXCJcbik7XG52YXIgcGFydHMgPSBhbmF0b215LmJ1aWxkKCk7XG52YXIgY29sbGVjdGlvbiA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiBuZXcgVHJlZUNvbGxlY3Rpb24ob3B0aW9ucyk7XG59O1xuY29sbGVjdGlvbi5lbXB0eSA9ICgpID0+IHtcbiAgcmV0dXJuIG5ldyBUcmVlQ29sbGVjdGlvbih7IHJvb3ROb2RlOiB7IGNoaWxkcmVuOiBbXSB9IH0pO1xufTtcbmZ1bmN0aW9uIGZpbGVQYXRoQ29sbGVjdGlvbihwYXRocykge1xuICByZXR1cm4gZmlsZVBhdGhUb1RyZWUocGF0aHMpO1xufVxuXG4vLyBzcmMvdHJlZS12aWV3LmRvbS50c1xudmFyIGdldFJvb3RJZCA9IChjdHgpID0+IGN0eC5pZHM/LnJvb3QgPz8gYHRyZWU6JHtjdHguaWR9OnJvb3RgO1xudmFyIGdldExhYmVsSWQgPSAoY3R4KSA9PiBjdHguaWRzPy5sYWJlbCA/PyBgdHJlZToke2N0eC5pZH06bGFiZWxgO1xudmFyIGdldE5vZGVJZCA9IChjdHgsIHZhbHVlKSA9PiBjdHguaWRzPy5ub2RlPy4odmFsdWUpID8/IGB0cmVlOiR7Y3R4LmlkfTpub2RlOiR7dmFsdWV9YDtcbnZhciBnZXRUcmVlSWQgPSAoY3R4KSA9PiBjdHguaWRzPy50cmVlID8/IGB0cmVlOiR7Y3R4LmlkfTp0cmVlYDtcbnZhciBmb2N1c05vZGUgPSAoY3R4LCB2YWx1ZSkgPT4ge1xuICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuO1xuICBjdHguZ2V0QnlJZChnZXROb2RlSWQoY3R4LCB2YWx1ZSkpPy5mb2N1cygpO1xufTtcbmZ1bmN0aW9uIGdldENoZWNrZWRTdGF0ZShjb2xsZWN0aW9uMiwgbm9kZSwgY2hlY2tlZFZhbHVlKSB7XG4gIGNvbnN0IHZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5vZGUpO1xuICBpZiAoIWNvbGxlY3Rpb24yLmlzQnJhbmNoTm9kZShub2RlKSkge1xuICAgIHJldHVybiBjaGVja2VkVmFsdWUuaW5jbHVkZXModmFsdWUpO1xuICB9XG4gIGNvbnN0IGNoaWxkVmFsdWVzID0gY29sbGVjdGlvbjIuZ2V0RGVzY2VuZGFudFZhbHVlcyh2YWx1ZSk7XG4gIGNvbnN0IGFsbENoZWNrZWQgPSBjaGlsZFZhbHVlcy5ldmVyeSgodikgPT4gY2hlY2tlZFZhbHVlLmluY2x1ZGVzKHYpKTtcbiAgY29uc3Qgc29tZUNoZWNrZWQgPSBjaGlsZFZhbHVlcy5zb21lKCh2KSA9PiBjaGVja2VkVmFsdWUuaW5jbHVkZXModikpO1xuICByZXR1cm4gYWxsQ2hlY2tlZCA/IHRydWUgOiBzb21lQ2hlY2tlZCA/IFwiaW5kZXRlcm1pbmF0ZVwiIDogZmFsc2U7XG59XG5mdW5jdGlvbiB0b2dnbGVCcmFuY2hDaGVja2VkKGNvbGxlY3Rpb24yLCB2YWx1ZSwgY2hlY2tlZFZhbHVlKSB7XG4gIGNvbnN0IGNoaWxkVmFsdWVzID0gY29sbGVjdGlvbjIuZ2V0RGVzY2VuZGFudFZhbHVlcyh2YWx1ZSk7XG4gIGNvbnN0IGFsbENoZWNrZWQgPSBjaGlsZFZhbHVlcy5ldmVyeSgoY2hpbGQpID0+IGNoZWNrZWRWYWx1ZS5pbmNsdWRlcyhjaGlsZCkpO1xuICByZXR1cm4gdW5pcShhbGxDaGVja2VkID8gcmVtb3ZlKGNoZWNrZWRWYWx1ZSwgLi4uY2hpbGRWYWx1ZXMpIDogYWRkKGNoZWNrZWRWYWx1ZSwgLi4uY2hpbGRWYWx1ZXMpKTtcbn1cbmZ1bmN0aW9uIGdldENoZWNrZWRWYWx1ZU1hcChjb2xsZWN0aW9uMiwgY2hlY2tlZFZhbHVlKSB7XG4gIGNvbnN0IG1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGNvbGxlY3Rpb24yLnZpc2l0KHtcbiAgICBvbkVudGVyOiAobm9kZSkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gICAgICBjb25zdCBpc0JyYW5jaCA9IGNvbGxlY3Rpb24yLmlzQnJhbmNoTm9kZShub2RlKTtcbiAgICAgIGNvbnN0IGNoZWNrZWQgPSBnZXRDaGVja2VkU3RhdGUoY29sbGVjdGlvbjIsIG5vZGUsIGNoZWNrZWRWYWx1ZSk7XG4gICAgICBtYXAuc2V0KHZhbHVlLCB7XG4gICAgICAgIHR5cGU6IGlzQnJhbmNoID8gXCJicmFuY2hcIiA6IFwibGVhZlwiLFxuICAgICAgICBjaGVja2VkXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gbWFwO1xufVxuXG4vLyBzcmMvdHJlZS12aWV3LmNvbm5lY3QudHNcbmZ1bmN0aW9uIGNvbm5lY3Qoc2VydmljZSwgbm9ybWFsaXplKSB7XG4gIGNvbnN0IHsgY29udGV4dCwgc2NvcGUsIGNvbXB1dGVkLCBwcm9wLCBzZW5kIH0gPSBzZXJ2aWNlO1xuICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICBjb25zdCBleHBhbmRlZFZhbHVlID0gQXJyYXkuZnJvbShjb250ZXh0LmdldChcImV4cGFuZGVkVmFsdWVcIikpO1xuICBjb25zdCBzZWxlY3RlZFZhbHVlID0gQXJyYXkuZnJvbShjb250ZXh0LmdldChcInNlbGVjdGVkVmFsdWVcIikpO1xuICBjb25zdCBjaGVja2VkVmFsdWUgPSBBcnJheS5mcm9tKGNvbnRleHQuZ2V0KFwiY2hlY2tlZFZhbHVlXCIpKTtcbiAgY29uc3QgaXNUeXBpbmdBaGVhZCA9IGNvbXB1dGVkKFwiaXNUeXBpbmdBaGVhZFwiKTtcbiAgY29uc3QgZm9jdXNlZFZhbHVlID0gY29udGV4dC5nZXQoXCJmb2N1c2VkVmFsdWVcIik7XG4gIGNvbnN0IGxvYWRpbmdTdGF0dXMgPSBjb250ZXh0LmdldChcImxvYWRpbmdTdGF0dXNcIik7XG4gIGZ1bmN0aW9uIGdldE5vZGVTdGF0ZShwcm9wczIpIHtcbiAgICBjb25zdCB7IG5vZGUsIGluZGV4UGF0aCB9ID0gcHJvcHMyO1xuICAgIGNvbnN0IHZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5vZGUpO1xuICAgIGNvbnN0IGZpcnN0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldEZpcnN0Tm9kZSgpO1xuICAgIGNvbnN0IGZpcnN0Tm9kZVZhbHVlID0gZmlyc3ROb2RlID8gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKGZpcnN0Tm9kZSkgOiBudWxsO1xuICAgIHJldHVybiB7XG4gICAgICBpZDogZ2V0Tm9kZUlkKHNjb3BlLCB2YWx1ZSksXG4gICAgICB2YWx1ZSxcbiAgICAgIGluZGV4UGF0aCxcbiAgICAgIHZhbHVlUGF0aDogY29sbGVjdGlvbjIuZ2V0VmFsdWVQYXRoKGluZGV4UGF0aCksXG4gICAgICBkaXNhYmxlZDogQm9vbGVhbihub2RlLmRpc2FibGVkKSxcbiAgICAgIGZvY3VzZWQ6IGZvY3VzZWRWYWx1ZSA9PSBudWxsID8gZmlyc3ROb2RlVmFsdWUgPT0gdmFsdWUgOiBmb2N1c2VkVmFsdWUgPT09IHZhbHVlLFxuICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkVmFsdWUuaW5jbHVkZXModmFsdWUpLFxuICAgICAgZXhwYW5kZWQ6IGV4cGFuZGVkVmFsdWUuaW5jbHVkZXModmFsdWUpLFxuICAgICAgbG9hZGluZzogbG9hZGluZ1N0YXR1c1t2YWx1ZV0gPT09IFwibG9hZGluZ1wiLFxuICAgICAgZGVwdGg6IGluZGV4UGF0aC5sZW5ndGgsXG4gICAgICBpc0JyYW5jaDogY29sbGVjdGlvbjIuaXNCcmFuY2hOb2RlKG5vZGUpLFxuICAgICAgZ2V0IGNoZWNrZWQoKSB7XG4gICAgICAgIHJldHVybiBnZXRDaGVja2VkU3RhdGUoY29sbGVjdGlvbjIsIG5vZGUsIGNoZWNrZWRWYWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb24yLFxuICAgIGV4cGFuZGVkVmFsdWUsXG4gICAgc2VsZWN0ZWRWYWx1ZSxcbiAgICBjaGVja2VkVmFsdWUsXG4gICAgdG9nZ2xlQ2hlY2tlZCh2YWx1ZSwgaXNCcmFuY2gpIHtcbiAgICAgIHNlbmQoeyB0eXBlOiBcIkNIRUNLRUQuVE9HR0xFXCIsIHZhbHVlLCBpc0JyYW5jaCB9KTtcbiAgICB9LFxuICAgIHNldENoZWNrZWQodmFsdWUpIHtcbiAgICAgIHNlbmQoeyB0eXBlOiBcIkNIRUNLRUQuU0VUXCIsIHZhbHVlIH0pO1xuICAgIH0sXG4gICAgY2xlYXJDaGVja2VkKCkge1xuICAgICAgc2VuZCh7IHR5cGU6IFwiQ0hFQ0tFRC5DTEVBUlwiIH0pO1xuICAgIH0sXG4gICAgZ2V0Q2hlY2tlZE1hcCgpIHtcbiAgICAgIHJldHVybiBnZXRDaGVja2VkVmFsdWVNYXAoY29sbGVjdGlvbjIsIGNoZWNrZWRWYWx1ZSk7XG4gICAgfSxcbiAgICBleHBhbmQodmFsdWUpIHtcbiAgICAgIHNlbmQoeyB0eXBlOiB2YWx1ZSA/IFwiQlJBTkNILkVYUEFORFwiIDogXCJFWFBBTkRFRC5BTExcIiwgdmFsdWUgfSk7XG4gICAgfSxcbiAgICBjb2xsYXBzZSh2YWx1ZSkge1xuICAgICAgc2VuZCh7IHR5cGU6IHZhbHVlID8gXCJCUkFOQ0guQ09MTEFQU0VcIiA6IFwiRVhQQU5ERUQuQ0xFQVJcIiwgdmFsdWUgfSk7XG4gICAgfSxcbiAgICBkZXNlbGVjdCh2YWx1ZSkge1xuICAgICAgc2VuZCh7IHR5cGU6IHZhbHVlID8gXCJOT0RFLkRFU0VMRUNUXCIgOiBcIlNFTEVDVEVELkNMRUFSXCIsIHZhbHVlIH0pO1xuICAgIH0sXG4gICAgc2VsZWN0KHZhbHVlKSB7XG4gICAgICBzZW5kKHsgdHlwZTogdmFsdWUgPyBcIk5PREUuU0VMRUNUXCIgOiBcIlNFTEVDVEVELkFMTFwiLCB2YWx1ZSwgaXNUcnVzdGVkOiBmYWxzZSB9KTtcbiAgICB9LFxuICAgIGdldFZpc2libGVOb2RlcygpIHtcbiAgICAgIHJldHVybiBjb21wdXRlZChcInZpc2libGVOb2Rlc1wiKS5tYXAoKHsgbm9kZSB9KSA9PiBub2RlKTtcbiAgICB9LFxuICAgIGZvY3VzKHZhbHVlKSB7XG4gICAgICBmb2N1c05vZGUoc2NvcGUsIHZhbHVlKTtcbiAgICB9LFxuICAgIHNlbGVjdFBhcmVudCh2YWx1ZSkge1xuICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGNvbGxlY3Rpb24yLmdldFBhcmVudE5vZGUodmFsdWUpO1xuICAgICAgaWYgKCFwYXJlbnROb2RlKSByZXR1cm47XG4gICAgICBjb25zdCBfc2VsZWN0ZWRWYWx1ZSA9IGFkZChzZWxlY3RlZFZhbHVlLCBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUocGFyZW50Tm9kZSkpO1xuICAgICAgc2VuZCh7IHR5cGU6IFwiU0VMRUNURUQuU0VUXCIsIHZhbHVlOiBfc2VsZWN0ZWRWYWx1ZSwgc3JjOiBcInNlbGVjdC5wYXJlbnRcIiB9KTtcbiAgICB9LFxuICAgIGV4cGFuZFBhcmVudCh2YWx1ZSkge1xuICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGNvbGxlY3Rpb24yLmdldFBhcmVudE5vZGUodmFsdWUpO1xuICAgICAgaWYgKCFwYXJlbnROb2RlKSByZXR1cm47XG4gICAgICBjb25zdCBfZXhwYW5kZWRWYWx1ZSA9IGFkZChleHBhbmRlZFZhbHVlLCBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUocGFyZW50Tm9kZSkpO1xuICAgICAgc2VuZCh7IHR5cGU6IFwiRVhQQU5ERUQuU0VUXCIsIHZhbHVlOiBfZXhwYW5kZWRWYWx1ZSwgc3JjOiBcImV4cGFuZC5wYXJlbnRcIiB9KTtcbiAgICB9LFxuICAgIHNldEV4cGFuZGVkVmFsdWUodmFsdWUpIHtcbiAgICAgIGNvbnN0IF9leHBhbmRlZFZhbHVlID0gdW5pcSh2YWx1ZSk7XG4gICAgICBzZW5kKHsgdHlwZTogXCJFWFBBTkRFRC5TRVRcIiwgdmFsdWU6IF9leHBhbmRlZFZhbHVlIH0pO1xuICAgIH0sXG4gICAgc2V0U2VsZWN0ZWRWYWx1ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgX3NlbGVjdGVkVmFsdWUgPSB1bmlxKHZhbHVlKTtcbiAgICAgIHNlbmQoeyB0eXBlOiBcIlNFTEVDVEVELlNFVFwiLCB2YWx1ZTogX3NlbGVjdGVkVmFsdWUgfSk7XG4gICAgfSxcbiAgICBnZXRSb290UHJvcHMoKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5yb290LmF0dHJzLFxuICAgICAgICBpZDogZ2V0Um9vdElkKHNjb3BlKSxcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldExhYmVsUHJvcHMoKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5sYWJlbC5hdHRycyxcbiAgICAgICAgaWQ6IGdldExhYmVsSWQoc2NvcGUpLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIilcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0VHJlZVByb3BzKCkge1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMudHJlZS5hdHRycyxcbiAgICAgICAgaWQ6IGdldFRyZWVJZChzY29wZSksXG4gICAgICAgIGRpcjogcHJvcChcImRpclwiKSxcbiAgICAgICAgcm9sZTogXCJ0cmVlXCIsXG4gICAgICAgIFwiYXJpYS1sYWJlbFwiOiBcIlRyZWUgVmlld1wiLFxuICAgICAgICBcImFyaWEtbGFiZWxsZWRieVwiOiBnZXRMYWJlbElkKHNjb3BlKSxcbiAgICAgICAgXCJhcmlhLW11bHRpc2VsZWN0YWJsZVwiOiBwcm9wKFwic2VsZWN0aW9uTW9kZVwiKSA9PT0gXCJtdWx0aXBsZVwiIHx8IHZvaWQgMCxcbiAgICAgICAgdGFiSW5kZXg6IC0xLFxuICAgICAgICBvbktleURvd24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgcmV0dXJuO1xuICAgICAgICAgIGlmIChpc0NvbXBvc2luZ0V2ZW50KGV2ZW50KSkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGV2ZW50KTtcbiAgICAgICAgICBpZiAoaXNFZGl0YWJsZUVsZW1lbnQodGFyZ2V0KSkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IG5vZGUgPSB0YXJnZXQ/LmNsb3Nlc3QoXCJbZGF0YS1wYXJ0PWJyYW5jaC1jb250cm9sXSwgW2RhdGEtcGFydD1pdGVtXVwiKTtcbiAgICAgICAgICBpZiAoIW5vZGUpIHJldHVybjtcbiAgICAgICAgICBjb25zdCBub2RlSWQgPSBub2RlLmRhdGFzZXQudmFsdWU7XG4gICAgICAgICAgaWYgKG5vZGVJZCA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFt6YWctanMvdHJlZS12aWV3XSBOb2RlIGlkIG5vdCBmb3VuZCBmb3Igbm9kZWAsIG5vZGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBpc0JyYW5jaE5vZGUgPSBub2RlLm1hdGNoZXMoXCJbZGF0YS1wYXJ0PWJyYW5jaC1jb250cm9sXVwiKTtcbiAgICAgICAgICBjb25zdCBrZXlNYXAgPSB7XG4gICAgICAgICAgICBBcnJvd0Rvd24oZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChpc01vZGlmaWVyS2V5KGV2ZW50MikpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuQVJST1dfRE9XTlwiLCBpZDogbm9kZUlkLCBzaGlmdEtleTogZXZlbnQyLnNoaWZ0S2V5IH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEFycm93VXAoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChpc01vZGlmaWVyS2V5KGV2ZW50MikpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuQVJST1dfVVBcIiwgaWQ6IG5vZGVJZCwgc2hpZnRLZXk6IGV2ZW50Mi5zaGlmdEtleSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBBcnJvd0xlZnQoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChpc01vZGlmaWVyS2V5KGV2ZW50MikgfHwgbm9kZS5kYXRhc2V0LmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgICAgIGV2ZW50Mi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogaXNCcmFuY2hOb2RlID8gXCJCUkFOQ0hfTk9ERS5BUlJPV19MRUZUXCIgOiBcIk5PREUuQVJST1dfTEVGVFwiLCBpZDogbm9kZUlkIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEFycm93UmlnaHQoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmICghaXNCcmFuY2hOb2RlIHx8IG5vZGUuZGF0YXNldC5kaXNhYmxlZCkgcmV0dXJuO1xuICAgICAgICAgICAgICBldmVudDIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IFwiQlJBTkNIX05PREUuQVJST1dfUklHSFRcIiwgaWQ6IG5vZGVJZCB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBIb21lKGV2ZW50Mikge1xuICAgICAgICAgICAgICBpZiAoaXNNb2RpZmllcktleShldmVudDIpKSByZXR1cm47XG4gICAgICAgICAgICAgIGV2ZW50Mi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogXCJOT0RFLkhPTUVcIiwgaWQ6IG5vZGVJZCwgc2hpZnRLZXk6IGV2ZW50Mi5zaGlmdEtleSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBFbmQoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChpc01vZGlmaWVyS2V5KGV2ZW50MikpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuRU5EXCIsIGlkOiBub2RlSWQsIHNoaWZ0S2V5OiBldmVudDIuc2hpZnRLZXkgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgU3BhY2UoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChub2RlLmRhdGFzZXQuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgaWYgKGlzVHlwaW5nQWhlYWQpIHtcbiAgICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogXCJUUkVFLlRZUEVBSEVBRFwiLCBrZXk6IGV2ZW50Mi5rZXkgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAga2V5TWFwLkVudGVyPy4oZXZlbnQyKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEVudGVyKGV2ZW50Mikge1xuICAgICAgICAgICAgICBpZiAobm9kZS5kYXRhc2V0LmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgICAgIGlmIChpc0FuY2hvckVsZW1lbnQodGFyZ2V0KSAmJiBpc01vZGlmaWVyS2V5KGV2ZW50MikpIHJldHVybjtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IGlzQnJhbmNoTm9kZSA/IFwiQlJBTkNIX05PREUuQ0xJQ0tcIiA6IFwiTk9ERS5DTElDS1wiLCBpZDogbm9kZUlkLCBzcmM6IFwia2V5Ym9hcmRcIiB9KTtcbiAgICAgICAgICAgICAgaWYgKCFpc0FuY2hvckVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIGV2ZW50Mi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCIqXCIoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChub2RlLmRhdGFzZXQuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIlNJQkxJTkdTLkVYUEFORFwiLCBpZDogbm9kZUlkIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGEoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmICghZXZlbnQyLm1ldGFLZXkgfHwgbm9kZS5kYXRhc2V0LmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgICAgIGV2ZW50Mi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogXCJTRUxFQ1RFRC5BTExcIiwgbW92ZUZvY3VzOiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3Qga2V5ID0gZ2V0RXZlbnRLZXkoZXZlbnQsIHsgZGlyOiBwcm9wKFwiZGlyXCIpIH0pO1xuICAgICAgICAgIGNvbnN0IGV4ZWMgPSBrZXlNYXBba2V5XTtcbiAgICAgICAgICBpZiAoZXhlYykge1xuICAgICAgICAgICAgZXhlYyhldmVudCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZ2V0QnlUeXBlYWhlYWQuaXNWYWxpZEV2ZW50KGV2ZW50KSkgcmV0dXJuO1xuICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIlRSRUUuVFlQRUFIRUFEXCIsIGtleTogZXZlbnQua2V5LCBpZDogbm9kZUlkIH0pO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0Tm9kZVN0YXRlLFxuICAgIGdldEl0ZW1Qcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuaXRlbS5hdHRycyxcbiAgICAgICAgaWQ6IG5vZGVTdGF0ZS5pZCxcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpLFxuICAgICAgICBcImRhdGEtb3duZWRieVwiOiBnZXRUcmVlSWQoc2NvcGUpLFxuICAgICAgICBcImRhdGEtcGF0aFwiOiBwcm9wczIuaW5kZXhQYXRoLmpvaW4oXCIvXCIpLFxuICAgICAgICBcImRhdGEtdmFsdWVcIjogbm9kZVN0YXRlLnZhbHVlLFxuICAgICAgICB0YWJJbmRleDogbm9kZVN0YXRlLmZvY3VzZWQgPyAwIDogLTEsXG4gICAgICAgIFwiZGF0YS1mb2N1c1wiOiBkYXRhQXR0cihub2RlU3RhdGUuZm9jdXNlZCksXG4gICAgICAgIHJvbGU6IFwidHJlZWl0ZW1cIixcbiAgICAgICAgXCJhcmlhLWN1cnJlbnRcIjogbm9kZVN0YXRlLnNlbGVjdGVkID8gXCJ0cnVlXCIgOiB2b2lkIDAsXG4gICAgICAgIFwiYXJpYS1zZWxlY3RlZFwiOiBub2RlU3RhdGUuZGlzYWJsZWQgPyB2b2lkIDAgOiBub2RlU3RhdGUuc2VsZWN0ZWQsXG4gICAgICAgIFwiZGF0YS1zZWxlY3RlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuc2VsZWN0ZWQpLFxuICAgICAgICBcImFyaWEtZGlzYWJsZWRcIjogYXJpYUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIFwiYXJpYS1sZXZlbFwiOiBub2RlU3RhdGUuZGVwdGgsXG4gICAgICAgIFwiZGF0YS1kZXB0aFwiOiBub2RlU3RhdGUuZGVwdGgsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgXCItLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aFxuICAgICAgICB9LFxuICAgICAgICBvbkZvY3VzKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgc2VuZCh7IHR5cGU6IFwiTk9ERS5GT0NVU1wiLCBpZDogbm9kZVN0YXRlLnZhbHVlIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkNsaWNrKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKG5vZGVTdGF0ZS5kaXNhYmxlZCkgcmV0dXJuO1xuICAgICAgICAgIGlmICghaXNMZWZ0Q2xpY2soZXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgaWYgKGlzQW5jaG9yRWxlbWVudChldmVudC5jdXJyZW50VGFyZ2V0KSAmJiBpc01vZGlmaWVyS2V5KGV2ZW50KSkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IGlzTWV0YUtleSA9IGV2ZW50Lm1ldGFLZXkgfHwgZXZlbnQuY3RybEtleTtcbiAgICAgICAgICBzZW5kKHsgdHlwZTogXCJOT0RFLkNMSUNLXCIsIGlkOiBub2RlU3RhdGUudmFsdWUsIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleSwgY3RybEtleTogaXNNZXRhS2V5IH0pO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGlmICghaXNBbmNob3JFbGVtZW50KGV2ZW50LmN1cnJlbnRUYXJnZXQpKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRJdGVtVGV4dFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3QgaXRlbVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5pdGVtVGV4dC5hdHRycyxcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKGl0ZW1TdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIFwiZGF0YS1zZWxlY3RlZFwiOiBkYXRhQXR0cihpdGVtU3RhdGUuc2VsZWN0ZWQpLFxuICAgICAgICBcImRhdGEtZm9jdXNcIjogZGF0YUF0dHIoaXRlbVN0YXRlLmZvY3VzZWQpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEl0ZW1JbmRpY2F0b3JQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IGl0ZW1TdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuaXRlbUluZGljYXRvci5hdHRycyxcbiAgICAgICAgXCJhcmlhLWhpZGRlblwiOiB0cnVlLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIoaXRlbVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLXNlbGVjdGVkXCI6IGRhdGFBdHRyKGl0ZW1TdGF0ZS5zZWxlY3RlZCksXG4gICAgICAgIFwiZGF0YS1mb2N1c1wiOiBkYXRhQXR0cihpdGVtU3RhdGUuZm9jdXNlZCksXG4gICAgICAgIGhpZGRlbjogIWl0ZW1TdGF0ZS5zZWxlY3RlZFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRCcmFuY2hQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoLmF0dHJzLFxuICAgICAgICBcImRhdGEtZGVwdGhcIjogbm9kZVN0YXRlLmRlcHRoLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIFwiZGF0YS1icmFuY2hcIjogbm9kZVN0YXRlLnZhbHVlLFxuICAgICAgICByb2xlOiBcInRyZWVpdGVtXCIsXG4gICAgICAgIFwiZGF0YS1vd25lZGJ5XCI6IGdldFRyZWVJZChzY29wZSksXG4gICAgICAgIFwiZGF0YS12YWx1ZVwiOiBub2RlU3RhdGUudmFsdWUsXG4gICAgICAgIFwiYXJpYS1sZXZlbFwiOiBub2RlU3RhdGUuZGVwdGgsXG4gICAgICAgIFwiYXJpYS1zZWxlY3RlZFwiOiBub2RlU3RhdGUuZGlzYWJsZWQgPyB2b2lkIDAgOiBub2RlU3RhdGUuc2VsZWN0ZWQsXG4gICAgICAgIFwiZGF0YS1wYXRoXCI6IHByb3BzMi5pbmRleFBhdGguam9pbihcIi9cIiksXG4gICAgICAgIFwiZGF0YS1zZWxlY3RlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuc2VsZWN0ZWQpLFxuICAgICAgICBcImFyaWEtZXhwYW5kZWRcIjogbm9kZVN0YXRlLmV4cGFuZGVkLFxuICAgICAgICBcImRhdGEtc3RhdGVcIjogbm9kZVN0YXRlLmV4cGFuZGVkID8gXCJvcGVuXCIgOiBcImNsb3NlZFwiLFxuICAgICAgICBcImFyaWEtZGlzYWJsZWRcIjogYXJpYUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIFwiZGF0YS1sb2FkaW5nXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5sb2FkaW5nKSxcbiAgICAgICAgXCJhcmlhLWJ1c3lcIjogYXJpYUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpLFxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIFwiLS1kZXB0aFwiOiBub2RlU3RhdGUuZGVwdGhcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRCcmFuY2hJbmRpY2F0b3JQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoSW5kaWNhdG9yLmF0dHJzLFxuICAgICAgICBcImFyaWEtaGlkZGVuXCI6IHRydWUsXG4gICAgICAgIFwiZGF0YS1zdGF0ZVwiOiBub2RlU3RhdGUuZXhwYW5kZWQgPyBcIm9wZW5cIiA6IFwiY2xvc2VkXCIsXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtc2VsZWN0ZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLnNlbGVjdGVkKSxcbiAgICAgICAgXCJkYXRhLWZvY3VzXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5mb2N1c2VkKSxcbiAgICAgICAgXCJkYXRhLWxvYWRpbmdcIjogZGF0YUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaFRyaWdnZXJQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoVHJpZ2dlci5hdHRycyxcbiAgICAgICAgcm9sZTogXCJidXR0b25cIixcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLXN0YXRlXCI6IG5vZGVTdGF0ZS5leHBhbmRlZCA/IFwib3BlblwiIDogXCJjbG9zZWRcIixcbiAgICAgICAgXCJkYXRhLXZhbHVlXCI6IG5vZGVTdGF0ZS52YWx1ZSxcbiAgICAgICAgXCJkYXRhLWxvYWRpbmdcIjogZGF0YUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpLFxuICAgICAgICBkaXNhYmxlZDogbm9kZVN0YXRlLmxvYWRpbmcsXG4gICAgICAgIG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgICBpZiAobm9kZVN0YXRlLmRpc2FibGVkIHx8IG5vZGVTdGF0ZS5sb2FkaW5nKSByZXR1cm47XG4gICAgICAgICAgc2VuZCh7IHR5cGU6IFwiQlJBTkNIX1RPR0dMRS5DTElDS1wiLCBpZDogbm9kZVN0YXRlLnZhbHVlIH0pO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaENvbnRyb2xQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoQ29udHJvbC5hdHRycyxcbiAgICAgICAgcm9sZTogXCJidXR0b25cIixcbiAgICAgICAgaWQ6IG5vZGVTdGF0ZS5pZCxcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpLFxuICAgICAgICB0YWJJbmRleDogbm9kZVN0YXRlLmZvY3VzZWQgPyAwIDogLTEsXG4gICAgICAgIFwiZGF0YS1wYXRoXCI6IHByb3BzMi5pbmRleFBhdGguam9pbihcIi9cIiksXG4gICAgICAgIFwiZGF0YS1zdGF0ZVwiOiBub2RlU3RhdGUuZXhwYW5kZWQgPyBcIm9wZW5cIiA6IFwiY2xvc2VkXCIsXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtc2VsZWN0ZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLnNlbGVjdGVkKSxcbiAgICAgICAgXCJkYXRhLWZvY3VzXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5mb2N1c2VkKSxcbiAgICAgICAgXCJkYXRhLXZhbHVlXCI6IG5vZGVTdGF0ZS52YWx1ZSxcbiAgICAgICAgXCJkYXRhLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aCxcbiAgICAgICAgXCJkYXRhLWxvYWRpbmdcIjogZGF0YUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpLFxuICAgICAgICBcImFyaWEtYnVzeVwiOiBhcmlhQXR0cihub2RlU3RhdGUubG9hZGluZyksXG4gICAgICAgIG9uRm9jdXMoZXZlbnQpIHtcbiAgICAgICAgICBzZW5kKHsgdHlwZTogXCJOT0RFLkZPQ1VTXCIsIGlkOiBub2RlU3RhdGUudmFsdWUgfSk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgICBpZiAobm9kZVN0YXRlLmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgaWYgKG5vZGVTdGF0ZS5sb2FkaW5nKSByZXR1cm47XG4gICAgICAgICAgaWYgKCFpc0xlZnRDbGljayhldmVudCkpIHJldHVybjtcbiAgICAgICAgICBpZiAoaXNBbmNob3JFbGVtZW50KGV2ZW50LmN1cnJlbnRUYXJnZXQpICYmIGlzTW9kaWZpZXJLZXkoZXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgY29uc3QgaXNNZXRhS2V5ID0gZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5O1xuICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIkJSQU5DSF9OT0RFLkNMSUNLXCIsIGlkOiBub2RlU3RhdGUudmFsdWUsIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleSwgY3RybEtleTogaXNNZXRhS2V5IH0pO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaFRleHRQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoVGV4dC5hdHRycyxcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLXN0YXRlXCI6IG5vZGVTdGF0ZS5leHBhbmRlZCA/IFwib3BlblwiIDogXCJjbG9zZWRcIixcbiAgICAgICAgXCJkYXRhLWxvYWRpbmdcIjogZGF0YUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaENvbnRlbnRQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZS5lbGVtZW50KHtcbiAgICAgICAgLi4ucGFydHMuYnJhbmNoQ29udGVudC5hdHRycyxcbiAgICAgICAgcm9sZTogXCJncm91cFwiLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIFwiZGF0YS1zdGF0ZVwiOiBub2RlU3RhdGUuZXhwYW5kZWQgPyBcIm9wZW5cIiA6IFwiY2xvc2VkXCIsXG4gICAgICAgIFwiZGF0YS1kZXB0aFwiOiBub2RlU3RhdGUuZGVwdGgsXG4gICAgICAgIFwiZGF0YS1wYXRoXCI6IHByb3BzMi5pbmRleFBhdGguam9pbihcIi9cIiksXG4gICAgICAgIFwiZGF0YS12YWx1ZVwiOiBub2RlU3RhdGUudmFsdWUsXG4gICAgICAgIGhpZGRlbjogIW5vZGVTdGF0ZS5leHBhbmRlZFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRCcmFuY2hJbmRlbnRHdWlkZVByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hJbmRlbnRHdWlkZS5hdHRycyxcbiAgICAgICAgXCJkYXRhLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXROb2RlQ2hlY2tib3hQcm9wcyhwcm9wczIpIHtcbiAgICAgIGNvbnN0IG5vZGVTdGF0ZSA9IGdldE5vZGVTdGF0ZShwcm9wczIpO1xuICAgICAgY29uc3QgY2hlY2tlZFN0YXRlID0gbm9kZVN0YXRlLmNoZWNrZWQ7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5ub2RlQ2hlY2tib3guYXR0cnMsXG4gICAgICAgIHRhYkluZGV4OiAtMSxcbiAgICAgICAgcm9sZTogXCJjaGVja2JveFwiLFxuICAgICAgICBcImRhdGEtc3RhdGVcIjogY2hlY2tlZFN0YXRlID09PSB0cnVlID8gXCJjaGVja2VkXCIgOiBjaGVja2VkU3RhdGUgPT09IGZhbHNlID8gXCJ1bmNoZWNrZWRcIiA6IFwiaW5kZXRlcm1pbmF0ZVwiLFxuICAgICAgICBcImFyaWEtY2hlY2tlZFwiOiBjaGVja2VkU3RhdGUgPT09IHRydWUgPyBcInRydWVcIiA6IGNoZWNrZWRTdGF0ZSA9PT0gZmFsc2UgPyBcImZhbHNlXCIgOiBcIm1peGVkXCIsXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBvbkNsaWNrKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHJldHVybjtcbiAgICAgICAgICBpZiAobm9kZVN0YXRlLmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgaWYgKCFpc0xlZnRDbGljayhldmVudCkpIHJldHVybjtcbiAgICAgICAgICBzZW5kKHsgdHlwZTogXCJDSEVDS0VELlRPR0dMRVwiLCB2YWx1ZTogbm9kZVN0YXRlLnZhbHVlLCBpc0JyYW5jaDogbm9kZVN0YXRlLmlzQnJhbmNoIH0pO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGNvbnN0IG5vZGUgPSBldmVudC5jdXJyZW50VGFyZ2V0LmNsb3Nlc3QoXCJbcm9sZT10cmVlaXRlbV1cIik7XG4gICAgICAgICAgbm9kZT8uZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBleHBhbmRCcmFuY2hlcyhwYXJhbXMsIHZhbHVlcykge1xuICBjb25zdCB7IGNvbnRleHQsIHByb3AsIHJlZnMgfSA9IHBhcmFtcztcbiAgaWYgKCFwcm9wKFwibG9hZENoaWxkcmVuXCIpKSB7XG4gICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIChwcmV2KSA9PiB1bmlxKGFkZChwcmV2LCAuLi52YWx1ZXMpKSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGxvYWRpbmdTdGF0dXMgPSBjb250ZXh0LmdldChcImxvYWRpbmdTdGF0dXNcIik7XG4gIGNvbnN0IFtsb2FkZWRWYWx1ZXMsIGxvYWRpbmdWYWx1ZXNdID0gcGFydGl0aW9uKHZhbHVlcywgKHZhbHVlKSA9PiBsb2FkaW5nU3RhdHVzW3ZhbHVlXSA9PT0gXCJsb2FkZWRcIik7XG4gIGlmIChsb2FkZWRWYWx1ZXMubGVuZ3RoID4gMCkge1xuICAgIGNvbnRleHQuc2V0KFwiZXhwYW5kZWRWYWx1ZVwiLCAocHJldikgPT4gdW5pcShhZGQocHJldiwgLi4ubG9hZGVkVmFsdWVzKSkpO1xuICB9XG4gIGlmIChsb2FkaW5nVmFsdWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICBjb25zdCBbbm9kZVdpdGhDaGlsZHJlbiwgbm9kZVdpdGhvdXRDaGlsZHJlbl0gPSBwYXJ0aXRpb24obG9hZGluZ1ZhbHVlcywgKGlkKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IGNvbGxlY3Rpb24yLmZpbmROb2RlKGlkKTtcbiAgICByZXR1cm4gY29sbGVjdGlvbjIuZ2V0Tm9kZUNoaWxkcmVuKG5vZGUpLmxlbmd0aCA+IDA7XG4gIH0pO1xuICBpZiAobm9kZVdpdGhDaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIChwcmV2KSA9PiB1bmlxKGFkZChwcmV2LCAuLi5ub2RlV2l0aENoaWxkcmVuKSkpO1xuICB9XG4gIGlmIChub2RlV2l0aG91dENoaWxkcmVuLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICBjb250ZXh0LnNldChcImxvYWRpbmdTdGF0dXNcIiwgKHByZXYpID0+ICh7XG4gICAgLi4ucHJldixcbiAgICAuLi5ub2RlV2l0aG91dENoaWxkcmVuLnJlZHVjZSgoYWNjLCBpZCkgPT4gKHsgLi4uYWNjLCBbaWRdOiBcImxvYWRpbmdcIiB9KSwge30pXG4gIH0pKTtcbiAgY29uc3Qgbm9kZXNUb0xvYWQgPSBub2RlV2l0aG91dENoaWxkcmVuLm1hcCgoaWQpID0+IHtcbiAgICBjb25zdCBpbmRleFBhdGggPSBjb2xsZWN0aW9uMi5nZXRJbmRleFBhdGgoaWQpO1xuICAgIGNvbnN0IHZhbHVlUGF0aCA9IGNvbGxlY3Rpb24yLmdldFZhbHVlUGF0aChpbmRleFBhdGgpO1xuICAgIGNvbnN0IG5vZGUgPSBjb2xsZWN0aW9uMi5maW5kTm9kZShpZCk7XG4gICAgcmV0dXJuIHsgaWQsIGluZGV4UGF0aCwgdmFsdWVQYXRoLCBub2RlIH07XG4gIH0pO1xuICBjb25zdCBwZW5kaW5nQWJvcnRzID0gcmVmcy5nZXQoXCJwZW5kaW5nQWJvcnRzXCIpO1xuICBjb25zdCBsb2FkQ2hpbGRyZW4gPSBwcm9wKFwibG9hZENoaWxkcmVuXCIpO1xuICBlbnN1cmUobG9hZENoaWxkcmVuLCAoKSA9PiBcIlt6YWctanMvdHJlZS12aWV3XSBgbG9hZENoaWxkcmVuYCBpcyByZXF1aXJlZCBmb3IgYXN5bmMgZXhwYW5zaW9uXCIpO1xuICBjb25zdCBwcm9tcyA9IG5vZGVzVG9Mb2FkLm1hcCgoeyBpZCwgaW5kZXhQYXRoLCB2YWx1ZVBhdGgsIG5vZGUgfSkgPT4ge1xuICAgIGNvbnN0IGV4aXN0aW5nQWJvcnQgPSBwZW5kaW5nQWJvcnRzLmdldChpZCk7XG4gICAgaWYgKGV4aXN0aW5nQWJvcnQpIHtcbiAgICAgIGV4aXN0aW5nQWJvcnQuYWJvcnQoKTtcbiAgICAgIHBlbmRpbmdBYm9ydHMuZGVsZXRlKGlkKTtcbiAgICB9XG4gICAgY29uc3QgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIHBlbmRpbmdBYm9ydHMuc2V0KGlkLCBhYm9ydENvbnRyb2xsZXIpO1xuICAgIHJldHVybiBsb2FkQ2hpbGRyZW4oe1xuICAgICAgdmFsdWVQYXRoLFxuICAgICAgaW5kZXhQYXRoLFxuICAgICAgbm9kZSxcbiAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbFxuICAgIH0pO1xuICB9KTtcbiAgUHJvbWlzZS5hbGxTZXR0bGVkKHByb21zKS50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgY29uc3QgbG9hZGVkVmFsdWVzMiA9IFtdO1xuICAgIGNvbnN0IG5vZGVXaXRoRXJyb3JzID0gW107XG4gICAgY29uc3QgbmV4dExvYWRpbmdTdGF0dXMgPSBjb250ZXh0LmdldChcImxvYWRpbmdTdGF0dXNcIik7XG4gICAgbGV0IGNvbGxlY3Rpb24zID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgcmVzdWx0cy5mb3JFYWNoKChyZXN1bHQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCB7IGlkLCBpbmRleFBhdGgsIG5vZGUsIHZhbHVlUGF0aCB9ID0gbm9kZXNUb0xvYWRbaW5kZXhdO1xuICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IFwiZnVsZmlsbGVkXCIpIHtcbiAgICAgICAgbmV4dExvYWRpbmdTdGF0dXNbaWRdID0gXCJsb2FkZWRcIjtcbiAgICAgICAgbG9hZGVkVmFsdWVzMi5wdXNoKGlkKTtcbiAgICAgICAgY29sbGVjdGlvbjMgPSBjb2xsZWN0aW9uMy5yZXBsYWNlKGluZGV4UGF0aCwgeyAuLi5ub2RlLCBjaGlsZHJlbjogcmVzdWx0LnZhbHVlIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGVuZGluZ0Fib3J0cy5kZWxldGUoaWQpO1xuICAgICAgICBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KG5leHRMb2FkaW5nU3RhdHVzLCBpZCk7XG4gICAgICAgIG5vZGVXaXRoRXJyb3JzLnB1c2goeyBub2RlLCBlcnJvcjogcmVzdWx0LnJlYXNvbiwgaW5kZXhQYXRoLCB2YWx1ZVBhdGggfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29udGV4dC5zZXQoXCJsb2FkaW5nU3RhdHVzXCIsIG5leHRMb2FkaW5nU3RhdHVzKTtcbiAgICBpZiAobG9hZGVkVmFsdWVzMi5sZW5ndGgpIHtcbiAgICAgIGNvbnRleHQuc2V0KFwiZXhwYW5kZWRWYWx1ZVwiLCAocHJldikgPT4gdW5pcShhZGQocHJldiwgLi4ubG9hZGVkVmFsdWVzMikpKTtcbiAgICAgIHByb3AoXCJvbkxvYWRDaGlsZHJlbkNvbXBsZXRlXCIpPy4oeyBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uMyB9KTtcbiAgICB9XG4gICAgaWYgKG5vZGVXaXRoRXJyb3JzLmxlbmd0aCkge1xuICAgICAgcHJvcChcIm9uTG9hZENoaWxkcmVuRXJyb3JcIik/Lih7IG5vZGVzOiBub2RlV2l0aEVycm9ycyB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyBzcmMvdXRpbHMvdmlzaXQtc2tpcC50c1xuZnVuY3Rpb24gc2tpcEZuKHBhcmFtcykge1xuICBjb25zdCB7IHByb3AsIGNvbnRleHQgfSA9IHBhcmFtcztcbiAgcmV0dXJuIGZ1bmN0aW9uIHNraXAoeyBpbmRleFBhdGggfSkge1xuICAgIGNvbnN0IHBhdGhzID0gcHJvcChcImNvbGxlY3Rpb25cIikuZ2V0VmFsdWVQYXRoKGluZGV4UGF0aCkuc2xpY2UoMCwgLTEpO1xuICAgIHJldHVybiBwYXRocy5zb21lKCh2YWx1ZSkgPT4gIWNvbnRleHQuZ2V0KFwiZXhwYW5kZWRWYWx1ZVwiKS5pbmNsdWRlcyh2YWx1ZSkpO1xuICB9O1xufVxuXG4vLyBzcmMvdHJlZS12aWV3Lm1hY2hpbmUudHNcbnZhciB7IGFuZCB9ID0gY3JlYXRlR3VhcmRzKCk7XG52YXIgbWFjaGluZSA9IGNyZWF0ZU1hY2hpbmUoe1xuICBwcm9wcyh7IHByb3BzOiBwcm9wczIgfSkge1xuICAgIHJldHVybiB7XG4gICAgICBzZWxlY3Rpb25Nb2RlOiBcInNpbmdsZVwiLFxuICAgICAgY29sbGVjdGlvbjogY29sbGVjdGlvbi5lbXB0eSgpLFxuICAgICAgdHlwZWFoZWFkOiB0cnVlLFxuICAgICAgZXhwYW5kT25DbGljazogdHJ1ZSxcbiAgICAgIGRlZmF1bHRFeHBhbmRlZFZhbHVlOiBbXSxcbiAgICAgIGRlZmF1bHRTZWxlY3RlZFZhbHVlOiBbXSxcbiAgICAgIC4uLnByb3BzMlxuICAgIH07XG4gIH0sXG4gIGluaXRpYWxTdGF0ZSgpIHtcbiAgICByZXR1cm4gXCJpZGxlXCI7XG4gIH0sXG4gIGNvbnRleHQoeyBwcm9wLCBiaW5kYWJsZSwgZ2V0Q29udGV4dCB9KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGFuZGVkVmFsdWU6IGJpbmRhYmxlKCgpID0+ICh7XG4gICAgICAgIGRlZmF1bHRWYWx1ZTogcHJvcChcImRlZmF1bHRFeHBhbmRlZFZhbHVlXCIpLFxuICAgICAgICB2YWx1ZTogcHJvcChcImV4cGFuZGVkVmFsdWVcIiksXG4gICAgICAgIGlzRXF1YWwsXG4gICAgICAgIG9uQ2hhbmdlKGV4cGFuZGVkVmFsdWUpIHtcbiAgICAgICAgICBjb25zdCBjdHggPSBnZXRDb250ZXh0KCk7XG4gICAgICAgICAgY29uc3QgZm9jdXNlZFZhbHVlID0gY3R4LmdldChcImZvY3VzZWRWYWx1ZVwiKTtcbiAgICAgICAgICBwcm9wKFwib25FeHBhbmRlZENoYW5nZVwiKT8uKHtcbiAgICAgICAgICAgIGV4cGFuZGVkVmFsdWUsXG4gICAgICAgICAgICBmb2N1c2VkVmFsdWUsXG4gICAgICAgICAgICBnZXQgZXhwYW5kZWROb2RlcygpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHByb3AoXCJjb2xsZWN0aW9uXCIpLmZpbmROb2RlcyhleHBhbmRlZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSkpLFxuICAgICAgc2VsZWN0ZWRWYWx1ZTogYmluZGFibGUoKCkgPT4gKHtcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBwcm9wKFwiZGVmYXVsdFNlbGVjdGVkVmFsdWVcIiksXG4gICAgICAgIHZhbHVlOiBwcm9wKFwic2VsZWN0ZWRWYWx1ZVwiKSxcbiAgICAgICAgaXNFcXVhbCxcbiAgICAgICAgb25DaGFuZ2Uoc2VsZWN0ZWRWYWx1ZSkge1xuICAgICAgICAgIGNvbnN0IGN0eCA9IGdldENvbnRleHQoKTtcbiAgICAgICAgICBjb25zdCBmb2N1c2VkVmFsdWUgPSBjdHguZ2V0KFwiZm9jdXNlZFZhbHVlXCIpO1xuICAgICAgICAgIHByb3AoXCJvblNlbGVjdGlvbkNoYW5nZVwiKT8uKHtcbiAgICAgICAgICAgIHNlbGVjdGVkVmFsdWUsXG4gICAgICAgICAgICBmb2N1c2VkVmFsdWUsXG4gICAgICAgICAgICBnZXQgc2VsZWN0ZWROb2RlcygpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHByb3AoXCJjb2xsZWN0aW9uXCIpLmZpbmROb2RlcyhzZWxlY3RlZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSkpLFxuICAgICAgZm9jdXNlZFZhbHVlOiBiaW5kYWJsZSgoKSA9PiAoe1xuICAgICAgICBkZWZhdWx0VmFsdWU6IHByb3AoXCJkZWZhdWx0Rm9jdXNlZFZhbHVlXCIpIHx8IG51bGwsXG4gICAgICAgIHZhbHVlOiBwcm9wKFwiZm9jdXNlZFZhbHVlXCIpLFxuICAgICAgICBvbkNoYW5nZShmb2N1c2VkVmFsdWUpIHtcbiAgICAgICAgICBwcm9wKFwib25Gb2N1c0NoYW5nZVwiKT8uKHtcbiAgICAgICAgICAgIGZvY3VzZWRWYWx1ZSxcbiAgICAgICAgICAgIGdldCBmb2N1c2VkTm9kZSgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZvY3VzZWRWYWx1ZSA/IHByb3AoXCJjb2xsZWN0aW9uXCIpLmZpbmROb2RlKGZvY3VzZWRWYWx1ZSkgOiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KSksXG4gICAgICBsb2FkaW5nU3RhdHVzOiBiaW5kYWJsZSgoKSA9PiAoe1xuICAgICAgICBkZWZhdWx0VmFsdWU6IHt9XG4gICAgICB9KSksXG4gICAgICBjaGVja2VkVmFsdWU6IGJpbmRhYmxlKCgpID0+ICh7XG4gICAgICAgIGRlZmF1bHRWYWx1ZTogcHJvcChcImRlZmF1bHRDaGVja2VkVmFsdWVcIikgfHwgW10sXG4gICAgICAgIHZhbHVlOiBwcm9wKFwiY2hlY2tlZFZhbHVlXCIpLFxuICAgICAgICBpc0VxdWFsLFxuICAgICAgICBvbkNoYW5nZSh2YWx1ZSkge1xuICAgICAgICAgIHByb3AoXCJvbkNoZWNrZWRDaGFuZ2VcIik/Lih7IGNoZWNrZWRWYWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pKVxuICAgIH07XG4gIH0sXG4gIHJlZnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGVhaGVhZFN0YXRlOiB7IC4uLmdldEJ5VHlwZWFoZWFkLmRlZmF1bHRPcHRpb25zIH0sXG4gICAgICBwZW5kaW5nQWJvcnRzOiAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpXG4gICAgfTtcbiAgfSxcbiAgY29tcHV0ZWQ6IHtcbiAgICBpc011bHRpcGxlU2VsZWN0aW9uOiAoeyBwcm9wIH0pID0+IHByb3AoXCJzZWxlY3Rpb25Nb2RlXCIpID09PSBcIm11bHRpcGxlXCIsXG4gICAgaXNUeXBpbmdBaGVhZDogKHsgcmVmcyB9KSA9PiByZWZzLmdldChcInR5cGVhaGVhZFN0YXRlXCIpLmtleXNTb0Zhci5sZW5ndGggPiAwLFxuICAgIHZpc2libGVOb2RlczogKHsgcHJvcCwgY29udGV4dCB9KSA9PiB7XG4gICAgICBjb25zdCBub2RlcyA9IFtdO1xuICAgICAgcHJvcChcImNvbGxlY3Rpb25cIikudmlzaXQoe1xuICAgICAgICBza2lwOiBza2lwRm4oeyBwcm9wLCBjb250ZXh0IH0pLFxuICAgICAgICBvbkVudGVyOiAobm9kZSwgaW5kZXhQYXRoKSA9PiB7XG4gICAgICAgICAgbm9kZXMucHVzaCh7IG5vZGUsIGluZGV4UGF0aCB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbm9kZXM7XG4gICAgfVxuICB9LFxuICBvbjoge1xuICAgIFwiRVhQQU5ERUQuU0VUXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcInNldEV4cGFuZGVkXCJdXG4gICAgfSxcbiAgICBcIkVYUEFOREVELkNMRUFSXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImNsZWFyRXhwYW5kZWRcIl1cbiAgICB9LFxuICAgIFwiRVhQQU5ERUQuQUxMXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImV4cGFuZEFsbEJyYW5jaGVzXCJdXG4gICAgfSxcbiAgICBcIkJSQU5DSC5FWFBBTkRcIjoge1xuICAgICAgYWN0aW9uczogW1wiZXhwYW5kQnJhbmNoZXNcIl1cbiAgICB9LFxuICAgIFwiQlJBTkNILkNPTExBUFNFXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImNvbGxhcHNlQnJhbmNoZXNcIl1cbiAgICB9LFxuICAgIFwiU0VMRUNURUQuU0VUXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcInNldFNlbGVjdGVkXCJdXG4gICAgfSxcbiAgICBcIlNFTEVDVEVELkFMTFwiOiBbXG4gICAgICB7XG4gICAgICAgIGd1YXJkOiBhbmQoXCJpc011bHRpcGxlU2VsZWN0aW9uXCIsIFwibW92ZUZvY3VzXCIpLFxuICAgICAgICBhY3Rpb25zOiBbXCJzZWxlY3RBbGxOb2Rlc1wiLCBcImZvY3VzVHJlZUxhc3ROb2RlXCJdXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBndWFyZDogXCJpc011bHRpcGxlU2VsZWN0aW9uXCIsXG4gICAgICAgIGFjdGlvbnM6IFtcInNlbGVjdEFsbE5vZGVzXCJdXG4gICAgICB9XG4gICAgXSxcbiAgICBcIlNFTEVDVEVELkNMRUFSXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImNsZWFyU2VsZWN0ZWRcIl1cbiAgICB9LFxuICAgIFwiTk9ERS5TRUxFQ1RcIjoge1xuICAgICAgYWN0aW9uczogW1wic2VsZWN0Tm9kZVwiXVxuICAgIH0sXG4gICAgXCJOT0RFLkRFU0VMRUNUXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImRlc2VsZWN0Tm9kZVwiXVxuICAgIH0sXG4gICAgXCJDSEVDS0VELlRPR0dMRVwiOiB7XG4gICAgICBhY3Rpb25zOiBbXCJ0b2dnbGVDaGVja2VkXCJdXG4gICAgfSxcbiAgICBcIkNIRUNLRUQuU0VUXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcInNldENoZWNrZWRcIl1cbiAgICB9LFxuICAgIFwiQ0hFQ0tFRC5DTEVBUlwiOiB7XG4gICAgICBhY3Rpb25zOiBbXCJjbGVhckNoZWNrZWRcIl1cbiAgICB9XG4gIH0sXG4gIGV4aXQ6IFtcImNsZWFyUGVuZGluZ0Fib3J0c1wiXSxcbiAgc3RhdGVzOiB7XG4gICAgaWRsZToge1xuICAgICAgb246IHtcbiAgICAgICAgXCJOT0RFLkZPQ1VTXCI6IHtcbiAgICAgICAgICBhY3Rpb25zOiBbXCJzZXRGb2N1c2VkTm9kZVwiXVxuICAgICAgICB9LFxuICAgICAgICBcIk5PREUuQVJST1dfRE9XTlwiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IGFuZChcImlzU2hpZnRLZXlcIiwgXCJpc011bHRpcGxlU2VsZWN0aW9uXCIpLFxuICAgICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNUcmVlTmV4dE5vZGVcIiwgXCJleHRlbmRTZWxlY3Rpb25Ub05leHROb2RlXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c1RyZWVOZXh0Tm9kZVwiXVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJOT0RFLkFSUk9XX1VQXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNTaGlmdEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c1RyZWVQcmV2Tm9kZVwiLCBcImV4dGVuZFNlbGVjdGlvblRvUHJldk5vZGVcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzVHJlZVByZXZOb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIk5PREUuQVJST1dfTEVGVFwiOiB7XG4gICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNCcmFuY2hOb2RlXCJdXG4gICAgICAgIH0sXG4gICAgICAgIFwiQlJBTkNIX05PREUuQVJST1dfTEVGVFwiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IFwiaXNCcmFuY2hFeHBhbmRlZFwiLFxuICAgICAgICAgICAgYWN0aW9uczogW1wiY29sbGFwc2VCcmFuY2hcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzQnJhbmNoTm9kZVwiXVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJCUkFOQ0hfTk9ERS5BUlJPV19SSUdIVFwiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IGFuZChcImlzQnJhbmNoRm9jdXNlZFwiLCBcImlzQnJhbmNoRXhwYW5kZWRcIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c0JyYW5jaEZpcnN0Tm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wiZXhwYW5kQnJhbmNoXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIlNJQkxJTkdTLkVYUEFORFwiOiB7XG4gICAgICAgICAgYWN0aW9uczogW1wiZXhwYW5kU2libGluZ0JyYW5jaGVzXCJdXG4gICAgICAgIH0sXG4gICAgICAgIFwiTk9ERS5IT01FXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNTaGlmdEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJleHRlbmRTZWxlY3Rpb25Ub0ZpcnN0Tm9kZVwiLCBcImZvY3VzVHJlZUZpcnN0Tm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNUcmVlRmlyc3ROb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIk5PREUuRU5EXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNTaGlmdEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJleHRlbmRTZWxlY3Rpb25Ub0xhc3ROb2RlXCIsIFwiZm9jdXNUcmVlTGFzdE5vZGVcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzVHJlZUxhc3ROb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIk5PREUuQ0xJQ0tcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc0N0cmxLZXlcIiwgXCJpc011bHRpcGxlU2VsZWN0aW9uXCIpLFxuICAgICAgICAgICAgYWN0aW9uczogW1widG9nZ2xlTm9kZVNlbGVjdGlvblwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IGFuZChcImlzU2hpZnRLZXlcIiwgXCJpc011bHRpcGxlU2VsZWN0aW9uXCIpLFxuICAgICAgICAgICAgYWN0aW9uczogW1wiZXh0ZW5kU2VsZWN0aW9uVG9Ob2RlXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJzZWxlY3ROb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIkJSQU5DSF9OT0RFLkNMSUNLXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNDdHJsS2V5XCIsIFwiaXNNdWx0aXBsZVNlbGVjdGlvblwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcInRvZ2dsZU5vZGVTZWxlY3Rpb25cIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc1NoaWZ0S2V5XCIsIFwiaXNNdWx0aXBsZVNlbGVjdGlvblwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImV4dGVuZFNlbGVjdGlvblRvTm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IFwiZXhwYW5kT25DbGlja1wiLFxuICAgICAgICAgICAgYWN0aW9uczogW1wic2VsZWN0Tm9kZVwiLCBcInRvZ2dsZUJyYW5jaE5vZGVcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcInNlbGVjdE5vZGVcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiQlJBTkNIX1RPR0dMRS5DTElDS1wiOiB7XG4gICAgICAgICAgYWN0aW9uczogW1widG9nZ2xlQnJhbmNoTm9kZVwiXVxuICAgICAgICB9LFxuICAgICAgICBcIlRSRUUuVFlQRUFIRUFEXCI6IHtcbiAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c01hdGNoZWROb2RlXCJdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGltcGxlbWVudGF0aW9uczoge1xuICAgIGd1YXJkczoge1xuICAgICAgaXNCcmFuY2hGb2N1c2VkOiAoeyBjb250ZXh0LCBldmVudCB9KSA9PiBjb250ZXh0LmdldChcImZvY3VzZWRWYWx1ZVwiKSA9PT0gZXZlbnQuaWQsXG4gICAgICBpc0JyYW5jaEV4cGFuZGVkOiAoeyBjb250ZXh0LCBldmVudCB9KSA9PiBjb250ZXh0LmdldChcImV4cGFuZGVkVmFsdWVcIikuaW5jbHVkZXMoZXZlbnQuaWQpLFxuICAgICAgaXNTaGlmdEtleTogKHsgZXZlbnQgfSkgPT4gZXZlbnQuc2hpZnRLZXksXG4gICAgICBpc0N0cmxLZXk6ICh7IGV2ZW50IH0pID0+IGV2ZW50LmN0cmxLZXksXG4gICAgICBoYXNTZWxlY3RlZEl0ZW1zOiAoeyBjb250ZXh0IH0pID0+IGNvbnRleHQuZ2V0KFwic2VsZWN0ZWRWYWx1ZVwiKS5sZW5ndGggPiAwLFxuICAgICAgaXNNdWx0aXBsZVNlbGVjdGlvbjogKHsgcHJvcCB9KSA9PiBwcm9wKFwic2VsZWN0aW9uTW9kZVwiKSA9PT0gXCJtdWx0aXBsZVwiLFxuICAgICAgbW92ZUZvY3VzOiAoeyBldmVudCB9KSA9PiAhIWV2ZW50Lm1vdmVGb2N1cyxcbiAgICAgIGV4cGFuZE9uQ2xpY2s6ICh7IHByb3AgfSkgPT4gISFwcm9wKFwiZXhwYW5kT25DbGlja1wiKVxuICAgIH0sXG4gICAgYWN0aW9uczoge1xuICAgICAgc2VsZWN0Tm9kZSh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBldmVudC5pZCB8fCBldmVudC52YWx1ZTtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIChwcmV2KSA9PiB7XG4gICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHJldHVybiBwcmV2O1xuICAgICAgICAgIGlmICghZXZlbnQuaXNUcnVzdGVkICYmIGlzQXJyYXkodmFsdWUpKSByZXR1cm4gcHJldi5jb25jYXQoLi4udmFsdWUpO1xuICAgICAgICAgIHJldHVybiBbaXNBcnJheSh2YWx1ZSkgPyBsYXN0KHZhbHVlKSA6IHZhbHVlXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGRlc2VsZWN0Tm9kZSh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0b0FycmF5KGV2ZW50LmlkIHx8IGV2ZW50LnZhbHVlKTtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIChwcmV2KSA9PiByZW1vdmUocHJldiwgLi4udmFsdWUpKTtcbiAgICAgIH0sXG4gICAgICBzZXRGb2N1c2VkTm9kZSh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJmb2N1c2VkVmFsdWVcIiwgZXZlbnQuaWQpO1xuICAgICAgfSxcbiAgICAgIGNsZWFyRm9jdXNlZE5vZGUoeyBjb250ZXh0IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJmb2N1c2VkVmFsdWVcIiwgbnVsbCk7XG4gICAgICB9LFxuICAgICAgY2xlYXJTZWxlY3RlZEl0ZW0oeyBjb250ZXh0IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIFtdKTtcbiAgICAgIH0sXG4gICAgICB0b2dnbGVCcmFuY2hOb2RlKHsgY29udGV4dCwgZXZlbnQsIGFjdGlvbiB9KSB7XG4gICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBjb250ZXh0LmdldChcImV4cGFuZGVkVmFsdWVcIikuaW5jbHVkZXMoZXZlbnQuaWQpO1xuICAgICAgICBhY3Rpb24oaXNFeHBhbmRlZCA/IFtcImNvbGxhcHNlQnJhbmNoXCJdIDogW1wiZXhwYW5kQnJhbmNoXCJdKTtcbiAgICAgIH0sXG4gICAgICBleHBhbmRCcmFuY2gocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgZXZlbnQgfSA9IHBhcmFtcztcbiAgICAgICAgZXhwYW5kQnJhbmNoZXMocGFyYW1zLCBbZXZlbnQuaWRdKTtcbiAgICAgIH0sXG4gICAgICBleHBhbmRCcmFuY2hlcyhwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBldmVudCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCB2YWx1ZXNUb0V4cGFuZCA9IHRvQXJyYXkoZXZlbnQudmFsdWUpO1xuICAgICAgICBleHBhbmRCcmFuY2hlcyhwYXJhbXMsIGRpZmYodmFsdWVzVG9FeHBhbmQsIGNvbnRleHQuZ2V0KFwiZXhwYW5kZWRWYWx1ZVwiKSkpO1xuICAgICAgfSxcbiAgICAgIGNvbGxhcHNlQnJhbmNoKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgKHByZXYpID0+IHJlbW92ZShwcmV2LCBldmVudC5pZCkpO1xuICAgICAgfSxcbiAgICAgIGNvbGxhcHNlQnJhbmNoZXMocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgZXZlbnQgfSA9IHBhcmFtcztcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0b0FycmF5KGV2ZW50LnZhbHVlKTtcbiAgICAgICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIChwcmV2KSA9PiByZW1vdmUocHJldiwgLi4udmFsdWUpKTtcbiAgICAgIH0sXG4gICAgICBzZXRFeHBhbmRlZCh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgaWYgKCFpc0FycmF5KGV2ZW50LnZhbHVlKSkgcmV0dXJuO1xuICAgICAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgZXZlbnQudmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGNsZWFyRXhwYW5kZWQoeyBjb250ZXh0IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIFtdKTtcbiAgICAgIH0sXG4gICAgICBzZXRTZWxlY3RlZCh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgaWYgKCFpc0FycmF5KGV2ZW50LnZhbHVlKSkgcmV0dXJuO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgZXZlbnQudmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGNsZWFyU2VsZWN0ZWQoeyBjb250ZXh0IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIFtdKTtcbiAgICAgIH0sXG4gICAgICBmb2N1c1RyZWVGaXJzdE5vZGUoeyBwcm9wLCBzY29wZSB9KSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGZpcnN0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldEZpcnN0Tm9kZSgpO1xuICAgICAgICBjb25zdCBmaXJzdFZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKGZpcnN0Tm9kZSk7XG4gICAgICAgIGZvY3VzTm9kZShzY29wZSwgZmlyc3RWYWx1ZSk7XG4gICAgICB9LFxuICAgICAgZm9jdXNUcmVlTGFzdE5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgcHJvcCwgc2NvcGUgfSA9IHBhcmFtcztcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgbGFzdE5vZGUgPSBjb2xsZWN0aW9uMi5nZXRMYXN0Tm9kZSh2b2lkIDAsIHsgc2tpcDogc2tpcEZuKHBhcmFtcykgfSk7XG4gICAgICAgIGNvbnN0IGxhc3RWYWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShsYXN0Tm9kZSk7XG4gICAgICAgIGZvY3VzTm9kZShzY29wZSwgbGFzdFZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBmb2N1c0JyYW5jaEZpcnN0Tm9kZSh7IGV2ZW50LCBwcm9wLCBzY29wZSB9KSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGJyYW5jaE5vZGUgPSBjb2xsZWN0aW9uMi5maW5kTm9kZShldmVudC5pZCk7XG4gICAgICAgIGNvbnN0IGZpcnN0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldEZpcnN0Tm9kZShicmFuY2hOb2RlKTtcbiAgICAgICAgY29uc3QgZmlyc3RWYWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShmaXJzdE5vZGUpO1xuICAgICAgICBmb2N1c05vZGUoc2NvcGUsIGZpcnN0VmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGZvY3VzVHJlZU5leHROb2RlKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGV2ZW50LCBwcm9wLCBzY29wZSB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBuZXh0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldE5leHROb2RlKGV2ZW50LmlkLCB7IHNraXA6IHNraXBGbihwYXJhbXMpIH0pO1xuICAgICAgICBpZiAoIW5leHROb2RlKSByZXR1cm47XG4gICAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShuZXh0Tm9kZSk7XG4gICAgICAgIGZvY3VzTm9kZShzY29wZSwgbmV4dFZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBmb2N1c1RyZWVQcmV2Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBldmVudCwgcHJvcCwgc2NvcGUgfSA9IHBhcmFtcztcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgcHJldk5vZGUgPSBjb2xsZWN0aW9uMi5nZXRQcmV2aW91c05vZGUoZXZlbnQuaWQsIHsgc2tpcDogc2tpcEZuKHBhcmFtcykgfSk7XG4gICAgICAgIGlmICghcHJldk5vZGUpIHJldHVybjtcbiAgICAgICAgY29uc3QgcHJldlZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKHByZXZOb2RlKTtcbiAgICAgICAgZm9jdXNOb2RlKHNjb3BlLCBwcmV2VmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGZvY3VzQnJhbmNoTm9kZSh7IGV2ZW50LCBwcm9wLCBzY29wZSB9KSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSBjb2xsZWN0aW9uMi5nZXRQYXJlbnROb2RlKGV2ZW50LmlkKTtcbiAgICAgICAgY29uc3QgcGFyZW50VmFsdWUgPSBwYXJlbnROb2RlID8gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKHBhcmVudE5vZGUpIDogdm9pZCAwO1xuICAgICAgICBmb2N1c05vZGUoc2NvcGUsIHBhcmVudFZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RBbGxOb2Rlcyh7IGNvbnRleHQsIHByb3AgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgcHJvcChcImNvbGxlY3Rpb25cIikuZ2V0VmFsdWVzKCkpO1xuICAgICAgfSxcbiAgICAgIGZvY3VzTWF0Y2hlZE5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgcHJvcCwgcmVmcywgZXZlbnQsIHNjb3BlLCBjb21wdXRlZCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBub2RlcyA9IGNvbXB1dGVkKFwidmlzaWJsZU5vZGVzXCIpO1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IG5vZGVzLm1hcCgoeyBub2RlOiBub2RlMiB9KSA9PiAoe1xuICAgICAgICAgIHRleHRDb250ZW50OiBwcm9wKFwiY29sbGVjdGlvblwiKS5zdHJpbmdpZnlOb2RlKG5vZGUyKSxcbiAgICAgICAgICBpZDogcHJvcChcImNvbGxlY3Rpb25cIikuZ2V0Tm9kZVZhbHVlKG5vZGUyKVxuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBnZXRCeVR5cGVhaGVhZChlbGVtZW50cywge1xuICAgICAgICAgIHN0YXRlOiByZWZzLmdldChcInR5cGVhaGVhZFN0YXRlXCIpLFxuICAgICAgICAgIGFjdGl2ZUlkOiBjb250ZXh0LmdldChcImZvY3VzZWRWYWx1ZVwiKSxcbiAgICAgICAgICBrZXk6IGV2ZW50LmtleVxuICAgICAgICB9KTtcbiAgICAgICAgZm9jdXNOb2RlKHNjb3BlLCBub2RlPy5pZCk7XG4gICAgICB9LFxuICAgICAgdG9nZ2xlTm9kZVNlbGVjdGlvbih7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZSA9IGFkZE9yUmVtb3ZlKGNvbnRleHQuZ2V0KFwic2VsZWN0ZWRWYWx1ZVwiKSwgZXZlbnQuaWQpO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgc2VsZWN0ZWRWYWx1ZSk7XG4gICAgICB9LFxuICAgICAgZXhwYW5kQWxsQnJhbmNoZXMocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgcHJvcCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBicmFuY2hWYWx1ZXMgPSBwcm9wKFwiY29sbGVjdGlvblwiKS5nZXRCcmFuY2hWYWx1ZXMoKTtcbiAgICAgICAgY29uc3QgdmFsdWVzVG9FeHBhbmQgPSBkaWZmKGJyYW5jaFZhbHVlcywgY29udGV4dC5nZXQoXCJleHBhbmRlZFZhbHVlXCIpKTtcbiAgICAgICAgZXhwYW5kQnJhbmNoZXMocGFyYW1zLCB2YWx1ZXNUb0V4cGFuZCk7XG4gICAgICB9LFxuICAgICAgZXhwYW5kU2libGluZ0JyYW5jaGVzKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGNvbnRleHQsIGV2ZW50LCBwcm9wIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGluZGV4UGF0aCA9IGNvbGxlY3Rpb24yLmdldEluZGV4UGF0aChldmVudC5pZCk7XG4gICAgICAgIGlmICghaW5kZXhQYXRoKSByZXR1cm47XG4gICAgICAgIGNvbnN0IG5vZGVzID0gY29sbGVjdGlvbjIuZ2V0U2libGluZ05vZGVzKGluZGV4UGF0aCk7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IG5vZGVzLm1hcCgobm9kZSkgPT4gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5vZGUpKTtcbiAgICAgICAgY29uc3QgdmFsdWVzVG9FeHBhbmQgPSBkaWZmKHZhbHVlcywgY29udGV4dC5nZXQoXCJleHBhbmRlZFZhbHVlXCIpKTtcbiAgICAgICAgZXhwYW5kQnJhbmNoZXMocGFyYW1zLCB2YWx1ZXNUb0V4cGFuZCk7XG4gICAgICB9LFxuICAgICAgZXh0ZW5kU2VsZWN0aW9uVG9Ob2RlKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGNvbnRleHQsIGV2ZW50LCBwcm9wLCBjb21wdXRlZCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBhbmNob3JWYWx1ZSA9IGZpcnN0KGNvbnRleHQuZ2V0KFwic2VsZWN0ZWRWYWx1ZVwiKSkgfHwgY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKGNvbGxlY3Rpb24yLmdldEZpcnN0Tm9kZSgpKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBldmVudC5pZDtcbiAgICAgICAgbGV0IHZhbHVlcyA9IFthbmNob3JWYWx1ZSwgdGFyZ2V0VmFsdWVdO1xuICAgICAgICBsZXQgaGl0cyA9IDA7XG4gICAgICAgIGNvbnN0IHZpc2libGVOb2RlcyA9IGNvbXB1dGVkKFwidmlzaWJsZU5vZGVzXCIpO1xuICAgICAgICB2aXNpYmxlTm9kZXMuZm9yRWFjaCgoeyBub2RlIH0pID0+IHtcbiAgICAgICAgICBjb25zdCBub2RlVmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gICAgICAgICAgaWYgKGhpdHMgPT09IDEpIHZhbHVlcy5wdXNoKG5vZGVWYWx1ZSk7XG4gICAgICAgICAgaWYgKG5vZGVWYWx1ZSA9PT0gYW5jaG9yVmFsdWUgfHwgbm9kZVZhbHVlID09PSB0YXJnZXRWYWx1ZSkgaGl0cysrO1xuICAgICAgICB9KTtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIHVuaXEodmFsdWVzKSk7XG4gICAgICB9LFxuICAgICAgZXh0ZW5kU2VsZWN0aW9uVG9OZXh0Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBldmVudCwgcHJvcCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBuZXh0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldE5leHROb2RlKGV2ZW50LmlkLCB7IHNraXA6IHNraXBGbihwYXJhbXMpIH0pO1xuICAgICAgICBpZiAoIW5leHROb2RlKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IG5ldyBTZXQoY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpKTtcbiAgICAgICAgY29uc3QgbmV4dFZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5leHROb2RlKTtcbiAgICAgICAgaWYgKG5leHRWYWx1ZSA9PSBudWxsKSByZXR1cm47XG4gICAgICAgIGlmICh2YWx1ZXMuaGFzKGV2ZW50LmlkKSAmJiB2YWx1ZXMuaGFzKG5leHRWYWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZXMuZGVsZXRlKGV2ZW50LmlkKTtcbiAgICAgICAgfSBlbHNlIGlmICghdmFsdWVzLmhhcyhuZXh0VmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWVzLmFkZChuZXh0VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCBBcnJheS5mcm9tKHZhbHVlcykpO1xuICAgICAgfSxcbiAgICAgIGV4dGVuZFNlbGVjdGlvblRvUHJldk5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgZXZlbnQsIHByb3AgfSA9IHBhcmFtcztcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgcHJldk5vZGUgPSBjb2xsZWN0aW9uMi5nZXRQcmV2aW91c05vZGUoZXZlbnQuaWQsIHsgc2tpcDogc2tpcEZuKHBhcmFtcykgfSk7XG4gICAgICAgIGlmICghcHJldk5vZGUpIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gbmV3IFNldChjb250ZXh0LmdldChcInNlbGVjdGVkVmFsdWVcIikpO1xuICAgICAgICBjb25zdCBwcmV2VmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUocHJldk5vZGUpO1xuICAgICAgICBpZiAocHJldlZhbHVlID09IG51bGwpIHJldHVybjtcbiAgICAgICAgaWYgKHZhbHVlcy5oYXMoZXZlbnQuaWQpICYmIHZhbHVlcy5oYXMocHJldlZhbHVlKSkge1xuICAgICAgICAgIHZhbHVlcy5kZWxldGUoZXZlbnQuaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKCF2YWx1ZXMuaGFzKHByZXZWYWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZXMuYWRkKHByZXZWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIEFycmF5LmZyb20odmFsdWVzKSk7XG4gICAgICB9LFxuICAgICAgZXh0ZW5kU2VsZWN0aW9uVG9GaXJzdE5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgcHJvcCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0aW9uID0gZmlyc3QoY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgICAgIGNvbGxlY3Rpb24yLnZpc2l0KHtcbiAgICAgICAgICBza2lwOiBza2lwRm4ocGFyYW1zKSxcbiAgICAgICAgICBvbkVudGVyOiAobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm9kZVZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5vZGUpO1xuICAgICAgICAgICAgdmFsdWVzLnB1c2gobm9kZVZhbHVlKTtcbiAgICAgICAgICAgIGlmIChub2RlVmFsdWUgPT09IGN1cnJlbnRTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFwic3RvcFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCB2YWx1ZXMpO1xuICAgICAgfSxcbiAgICAgIGV4dGVuZFNlbGVjdGlvblRvTGFzdE5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgcHJvcCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0aW9uID0gZmlyc3QoY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgICAgIGxldCBjdXJyZW50ID0gZmFsc2U7XG4gICAgICAgIGNvbGxlY3Rpb24yLnZpc2l0KHtcbiAgICAgICAgICBza2lwOiBza2lwRm4ocGFyYW1zKSxcbiAgICAgICAgICBvbkVudGVyOiAobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm9kZVZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKG5vZGVWYWx1ZSA9PT0gY3VycmVudFNlbGVjdGlvbikgY3VycmVudCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoY3VycmVudCkgdmFsdWVzLnB1c2gobm9kZVZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgdmFsdWVzKTtcbiAgICAgIH0sXG4gICAgICBjbGVhclBlbmRpbmdBYm9ydHMoeyByZWZzIH0pIHtcbiAgICAgICAgY29uc3QgYWJvcnRzID0gcmVmcy5nZXQoXCJwZW5kaW5nQWJvcnRzXCIpO1xuICAgICAgICBhYm9ydHMuZm9yRWFjaCgoYWJvcnQpID0+IGFib3J0LmFib3J0KCkpO1xuICAgICAgICBhYm9ydHMuY2xlYXIoKTtcbiAgICAgIH0sXG4gICAgICB0b2dnbGVDaGVja2VkKHsgY29udGV4dCwgZXZlbnQsIHByb3AgfSkge1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb250ZXh0LnNldChcbiAgICAgICAgICBcImNoZWNrZWRWYWx1ZVwiLFxuICAgICAgICAgIChwcmV2KSA9PiBldmVudC5pc0JyYW5jaCA/IHRvZ2dsZUJyYW5jaENoZWNrZWQoY29sbGVjdGlvbjIsIGV2ZW50LnZhbHVlLCBwcmV2KSA6IGFkZE9yUmVtb3ZlKHByZXYsIGV2ZW50LnZhbHVlKVxuICAgICAgICApO1xuICAgICAgfSxcbiAgICAgIHNldENoZWNrZWQoeyBjb250ZXh0LCBldmVudCB9KSB7XG4gICAgICAgIGNvbnRleHQuc2V0KFwiY2hlY2tlZFZhbHVlXCIsIGV2ZW50LnZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBjbGVhckNoZWNrZWQoeyBjb250ZXh0IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJjaGVja2VkVmFsdWVcIiwgW10pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG52YXIgcHJvcHMgPSBjcmVhdGVQcm9wcygpKFtcbiAgXCJpZHNcIixcbiAgXCJjb2xsZWN0aW9uXCIsXG4gIFwiZGlyXCIsXG4gIFwiZXhwYW5kZWRWYWx1ZVwiLFxuICBcImV4cGFuZE9uQ2xpY2tcIixcbiAgXCJkZWZhdWx0Rm9jdXNlZFZhbHVlXCIsXG4gIFwiZm9jdXNlZFZhbHVlXCIsXG4gIFwiZ2V0Um9vdE5vZGVcIixcbiAgXCJpZFwiLFxuICBcIm9uRXhwYW5kZWRDaGFuZ2VcIixcbiAgXCJvbkZvY3VzQ2hhbmdlXCIsXG4gIFwib25TZWxlY3Rpb25DaGFuZ2VcIixcbiAgXCJjaGVja2VkVmFsdWVcIixcbiAgXCJzZWxlY3RlZFZhbHVlXCIsXG4gIFwic2VsZWN0aW9uTW9kZVwiLFxuICBcInR5cGVhaGVhZFwiLFxuICBcImRlZmF1bHRFeHBhbmRlZFZhbHVlXCIsXG4gIFwiZGVmYXVsdFNlbGVjdGVkVmFsdWVcIixcbiAgXCJkZWZhdWx0Q2hlY2tlZFZhbHVlXCIsXG4gIFwib25DaGVja2VkQ2hhbmdlXCIsXG4gIFwib25Mb2FkQ2hpbGRyZW5Db21wbGV0ZVwiLFxuICBcIm9uTG9hZENoaWxkcmVuRXJyb3JcIixcbiAgXCJsb2FkQ2hpbGRyZW5cIlxuXSk7XG52YXIgc3BsaXRQcm9wcyA9IGNyZWF0ZVNwbGl0UHJvcHMocHJvcHMpO1xudmFyIGl0ZW1Qcm9wcyA9IGNyZWF0ZVByb3BzKCkoW1wibm9kZVwiLCBcImluZGV4UGF0aFwiXSk7XG52YXIgc3BsaXRJdGVtUHJvcHMgPSBjcmVhdGVTcGxpdFByb3BzKGl0ZW1Qcm9wcyk7XG5cbmV4cG9ydCB7IGFuYXRvbXksIGNvbGxlY3Rpb24sIGNvbm5lY3QsIGZpbGVQYXRoQ29sbGVjdGlvbiwgaXRlbVByb3BzLCBtYWNoaW5lLCBwcm9wcywgc3BsaXRJdGVtUHJvcHMsIHNwbGl0UHJvcHMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@zag-js+tree-view@1.21.7/node_modules/@zag-js/tree-view/dist/index.mjs\n");

/***/ })

};
;